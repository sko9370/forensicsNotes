!function(){var e,t,n;!function(i){function r(e,t){return y.call(e,t)}function s(e,t){var n,i,r,s,o,a,u,l,c,d,h=t&&t.split("/"),g=b.map,p=g&&g["*"]||{};if(e&&"."===e.charAt(0))if(t){for(h=h.slice(0,h.length-1),e=h.concat(e.split("/")),l=0;l<e.length;l+=1)if(d=e[l],"."===d)e.splice(l,1),l-=1;else if(".."===d){if(1===l&&(".."===e[2]||".."===e[0]))break;l>0&&(e.splice(l-1,2),l-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((h||p)&&g){for(n=e.split("/"),l=n.length;l>0;l-=1){if(i=n.slice(0,l).join("/"),h)for(c=h.length;c>0;c-=1)if(r=g[h.slice(0,c).join("/")],r&&(r=r[i])){s=r,o=l;break}if(s)break;!a&&p&&p[i]&&(a=p[i],u=l)}!s&&a&&(s=a,o=u),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function o(e,t){return function(){return g.apply(i,k.call(arguments,0).concat([e,t]))}}function a(e){return function(t){return s(t,e)}}function u(e){return function(t){m[e]=t}}function l(e){if(r(_,e)){var t=_[e];delete _[e],v[e]=!0,h.apply(i,t)}if(!r(m,e)&&!r(v,e))throw new Error("No "+e);return m[e]}function c(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function d(e){return function(){return b&&b.config&&b.config[e]||{}}}var h,g,p,f,m={},_={},b={},v={},y=Object.prototype.hasOwnProperty,k=[].slice;p=function(e,t){var n,i=c(e),r=i[0];return e=i[1],r&&(r=s(r,t),n=l(r)),r?e=n&&n.normalize?n.normalize(e,a(t)):s(e,t):(e=s(e,t),i=c(e),r=i[0],e=i[1],r&&(n=l(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},f={require:function(e){return o(e)},exports:function(e){var t=m[e];return"undefined"!=typeof t?t:m[e]={}},module:function(e){return{id:e,uri:"",exports:m[e],config:d(e)}}},h=function(e,t,n,s){var a,c,d,h,g,b,y=[];if(s=s||e,"function"==typeof n){for(t=!t.length&&n.length?["require","exports","module"]:t,g=0;g<t.length;g+=1)if(h=p(t[g],s),c=h.f,"require"===c)y[g]=f.require(e);else if("exports"===c)y[g]=f.exports(e),b=!0;else if("module"===c)a=y[g]=f.module(e);else if(r(m,c)||r(_,c)||r(v,c))y[g]=l(c);else{if(!h.p)throw new Error(e+" missing "+c);h.p.load(h.n,o(s,!0),u(c),{}),y[g]=m[c]}d=n.apply(m[e],y),e&&(a&&a.exports!==i&&a.exports!==m[e]?m[e]=a.exports:d===i&&b||(m[e]=d))}else e&&(m[e]=n)},e=t=g=function(e,t,n,r,s){return"string"==typeof e?f[e]?f[e](t):l(p(e,t).f):(e.splice||(b=e,t.splice?(e=t,t=n,n=null):e=i),t=t||function(){},"function"==typeof n&&(n=r,r=s),r?h(i,e,t,n):setTimeout(function(){h(i,e,t,n)},4),g)},g.config=function(e){return b=e,b.deps&&g(b.deps,b.callback),g},n=function(e,t,n){t.splice||(n=t,t=[]),r(m,e)||r(_,e)||(_[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("../node_modules/almond/almond.js",function(){}),function(e,t,i){"undefined"!=typeof module?module.exports=i(e,t):"function"==typeof n&&"object"==typeof n.amd?n("lib/radio",i):t[e]=i(e,t)}("radio",this,function(e,t){function n(e){return n.$.channel(e),n.$}return n.$={version:"0.2",channelName:"",channels:[],broadcast:function(){var e,n,i,r,s=this.channels[this.channelName],o=s.length;for(e=0;o>e;e++)n=s[e],"object"==typeof n&&n.length&&(i=n[0],r=n[1]||t),i.apply(r,arguments);return this},channel:function(e){var t=this.channels;return t[e]||(t[e]=[]),this.channelName=e,this},subscribe:function(){var e,t,n=arguments,i=this.channels[this.channelName],r=n.length,s=[];for(e=0;r>e;e++)s=n[e],t="function"==typeof s?[s]:s,"object"==typeof t&&t.length&&i.push(t);return this},unsubscribe:function(){var e,t,n,i=arguments,r=this.channels[this.channelName],s=i.length,o=r.length,a=0;for(e=0;s>e;e++)for(a=0,o=r.length,t=0;o>t;t++)n=t-a,r[n][0]===i[e]&&(r.splice(n,1),a++);return this}},n}),function(e){"undefined"!=typeof module&&module&&module.exports?module.exports=e():"function"==typeof n&&n.amd?n("lib/p",e):P=e()}(function(){function e(){for(;_.n;){_=_.n;var e=_.f;_.f=null,e()}v=!1}function t(e){return"object"===e||"function"===e}function n(e,t){for(var n=0,i=e.length;i>n;++n)n in e&&t(e[n],n)}function i(e){try{if(!r.onerror)throw e;r.onerror(e)}catch(t){setTimeout(function(){throw t},0)}}function r(e){return e instanceof c?e:a(new c,e)}function s(e,t,i){return e._state?e:(e._state=t,e._value=i,e._pending.length>0&&n(e._pending,N),e._pending=null,e)}function o(e,t){e._pending.push(t)}function a(e,t){return e._state?e:(t instanceof c?t===e?s(e,x,new TypeError("You can't resolve a promise with itself")):t._state?s(e,t._state,t._value):o(t,function(){s(e,t._state,t._value)}):t!==Object(t)?s(e,S,t):N(function(){var n=u(e,t);try{var i=t.then;"function"==typeof i?k.call(i,t,n.resolve,n.reject):s(e,S,t)}catch(r){n.reject(r)}}),e)}function u(e,t){var n=!1;return{promise:e,resolve:function(i){n||(n=!0,t&&t===i?s(e,S,i):a(e,i))},reject:function(t){n||(n=!0,s(e,x,t))}}}function l(){return u(new c)}function c(){this._state=0,this._value=void 0,this._pending=[]}function d(e){function t(t){return e(t,[])}function n(e){return r(e).then(t)}return n._=e,n}function h(e,t){var i=0,a=new c;return n(e,function(e,n){var u=r(e);u._state===E?(++i,o(u,function(){t[n]=u.inspect(),0===--i&&s(a,S,t)})):t[n]=u.inspect()}),0===i&&s(a,S,t),a}function g(e,t){var i=0,s=l();return n(e,function(e,n){var o=r(e);o._state===S?t[n]=o._value:(++i,o.then(function(e){t[n]=e,0===--i&&s.resolve(t)},s.reject))}),0===i&&s.resolve(t),s.promise}function p(e){function t(t){return w.apply(e,t)}return function(){var e=g(arguments,[]);return g([this,e],[]).then(t)}}var f,m,_={f:null,n:null},b=_,v=!1,y=t(typeof window)&&window||t(typeof worker)&&worker,k=t.call,w=t.apply,N=function(t){b=b.n={f:t,n:null},v||(v=!0,m(e,0))};t(typeof process)&&process&&process.nextTick?m=process.nextTick:t(typeof setImmediate)?m=y?function(e){y.setImmediate(e)}:function(e){setImmediate(e)}:t(typeof MessageChannel)?(f=new MessageChannel,f.port1.onmessage=e,m=function(){f.port2.postMessage(0)}):(m=setTimeout,y&&t(typeof Image)&&Image&&function(){var e=0,t=function(e){var t=new Image;t.onerror=e,t.src="data:image/png,"};try{t(function(){0===--e&&(m=t)}),++e}catch(n){}e&&setTimeout(function(){e=0},0)}());var E=0,S=1,x=2;return r.defer=l,c.prototype.then=function(e,t){function n(){var e,t=u._state===S?i:r;if(null!==t){try{e=t(u._value)}catch(n){return s(l,x,n),void 0}a(l,e)}else s(l,u._state,u._value)}var i="function"==typeof e?e:null,r="function"==typeof t?t:null,u=this,l=new c;return u._state===E?o(u,n):N(n),l},c.prototype.done=function(e,t){var n=this;(e||t)&&(n=n.then(e,t)),n.then(null,i)},c.prototype.fail=function(e){return this.then(null,e)},c.prototype.spread=function(e,t){return this.then(e&&function(n){return g(n,[]).then(function(t){return w.call(e,void 0,t)},t)},t)},c.prototype.timeout=function(e,t){var n=this,i=new c;if(n._state!==E)s(i,n._state,n._value);else{var r=setTimeout(function(){s(i,x,new Error(t||"Timed out after "+e+" ms"))},e);o(n,function(){clearTimeout(r),s(i,n._state,n._value)})}return i},c.prototype.delay=function(e){var t=this,n=new c;return setTimeout(function(){a(n,t)},e),n},c.prototype.inspect=function(){switch(this._state){case E:return{state:"pending"};case S:return{state:"fulfilled",value:this._value};case x:return{state:"rejected",reason:this._value};default:throw new TypeError("invalid state")}},r.allSettled=d(h),r.all=d(g),r.promised=p,r.onerror=null,r.nextTick=function(e){N(function(){try{e()}catch(t){setTimeout(function(){throw t},0)}})},r}),function(e){function t(e,t,n){for(var i=(n||0)-1,r=e.length;++i<r;)if(e[i]===t)return i;return-1}function i(e,n){var i=typeof n;if(e=e.cache,"boolean"==i||null==n)return e[n];"number"!=i&&"string"!=i&&(i="object");var r="number"==i?n:N+n;return e=e[i]||(e[i]={}),"object"==i?e[r]&&t(e[r],n)>-1?0:-1:e[r]?0:-1}function r(e){var t=this.cache,n=typeof e;if("boolean"==n||null==e)t[e]=!0;else{"number"!=n&&"string"!=n&&(n="object");var i="number"==n?e:N+e,r=t[n]||(t[n]={});"object"==n?(r[i]||(r[i]=[])).push(e)==this.array.length&&(t[n]=!1):r[i]=!0}}function s(e){return e.charCodeAt(0)}function o(e,t){var n=e.index,i=t.index;if(e=e.criteria,t=t.criteria,e!==t){if(e>t||"undefined"==typeof e)return 1;if(t>e||"undefined"==typeof t)return-1}return i>n?-1:1}function a(e){var t=-1,n=e.length,i=c();i["false"]=i["null"]=i["true"]=i.undefined=!1;var s=c();for(s.array=e,s.cache=i,s.push=r;++t<n;)s.push(e[t]);return i.object===!1?(p(s),null):s}function u(e){return"\\"+et[e]}function l(){return b.pop()||[]}function c(){return v.pop()||{args:"",array:null,bottom:"",cache:null,criteria:null,"false":!1,firstArg:"",index:0,init:"",leading:!1,loop:"",maxWait:0,"null":!1,number:null,object:null,push:null,shadowedProps:null,string:null,top:"",trailing:!1,"true":!1,undefined:!1,useHas:!1,useKeys:!1,value:null}}function d(e){return"function"!=typeof e.toString&&"string"==typeof(e+"")}function h(){}function g(e){e.length=0,b.length<S&&b.push(e)}function p(e){var t=e.cache;t&&p(t),e.array=e.cache=e.criteria=e.object=e.number=e.string=e.value=null,v.length<S&&v.push(e)}function f(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var i=-1,r=n-t||0,s=Array(0>r?0:r);++i<r;)s[i]=e[t+i];return s}function m(n){function r(e){return e&&"object"==typeof e&&!Ui(e)&&mi.call(e,"__wrapped__")?e:new b(e)}function b(e){this.__wrapped__=e}function v(e,t,n,i){function r(){var i=arguments,l=o?this:t;if(s||(e=t[a]),n.length&&(i=i.length?(i=Oi.call(i),u?i.concat(n):n.concat(i)):n),this instanceof r){l=et(e.prototype);var c=e.apply(l,i);return wt(c)?c:l}return e.apply(l,i)}var s=kt(e),o=!n,a=t;if(o){var u=i;n=t}else if(!s){if(!i)throw new ii;t=e}return r}function S(){var e=c();e.shadowedProps=H,e.array=e.bottom=e.loop=e.top="",e.init="iterable",e.useHas=!0,e.useKeys=!!Vi;for(var t,n=0;t=arguments[n];n++)for(var i in t)e[i]=t[i];var s=e.args;e.firstArg=/^[^,]+/.exec(s)[0];var o=Xn("errorClass, errorProto, hasOwnProperty, isArguments, isArray, isString, keys, lodash, objectProto, objectTypes, nonEnumProps, stringClass, stringProto, toString","return function("+s+") {\n"+ji(e)+"\n}");return p(e),o(z,si,mi,ut,Ui,Ct,Vi,r,oi,Z,Ri,X,ai,ki)}function et(e){return wt(e)?Ni(e):{}}function tt(e){return zi[e]}function it(){var e=(e=r.indexOf)===on?t:e;return e}function st(e){return function(t,n,i,s){return"boolean"!=typeof n&&null!=n&&(s=i,i=s&&s[n]===t?_:n,n=!1),null!=i&&(i=r.createCallback(i,s)),e(t,n,i,s)}}function ot(e){var t,n;return!e||ki.call(e)!=Q||(t=e.constructor,kt(t)&&!(t instanceof t))||!Bi.argsClass&&ut(e)||!Bi.nodeClass&&d(e)?!1:Bi.ownLast?(Ji(e,function(e,t,i){return n=mi.call(i,t),!1}),n!==!1):(Ji(e,function(e,t){n=t}),n===_||mi.call(e,n))}function at(e){return Gi[e]}function ut(e){return ki.call(e)==U}function lt(e,t,n,i,s,o){var a=e;if("boolean"!=typeof t&&null!=t&&(i=n,n=t,t=!1),"function"==typeof n){if(n="undefined"==typeof i?n:r.createCallback(n,i,1),a=n(a),"undefined"!=typeof a)return a;a=e}var u=wt(a);if(u){var c=ki.call(a);if(!Y[c]||!Bi.nodeClass&&d(a))return a;var h=Ui(a)}if(!u||!t)return u?h?f(a):Wi({},a):a;var p=Li[c];switch(c){case V:case $:return new p(+a);case W:case X:return new p(a);case J:return p(a.source,P.exec(a))}var m=!s;s||(s=l()),o||(o=l());for(var b=s.length;b--;)if(s[b]==e)return o[b];return a=h?p(a.length):{},h&&(mi.call(e,"index")&&(a.index=e.index),mi.call(e,"input")&&(a.input=e.input)),s.push(e),o.push(a),(h?$i:Xi)(e,function(e,i){a[i]=lt(e,t,n,_,s,o)}),m&&(g(s),g(o)),a}function ct(e,t,n){return lt(e,!0,t,n)}function dt(e,t,n){var i;return t=r.createCallback(t,n),Xi(e,function(e,n,r){return t(e,n,r)?(i=n,!1):void 0}),i}function ht(e){var t=[];return Ji(e,function(e,n){kt(e)&&t.push(n)}),t.sort()}function gt(e,t){return e?mi.call(e,t):!1}function pt(e){for(var t=-1,n=Vi(e),i=n.length,r={};++t<i;){var s=n[t];r[e[s]]=s}return r}function ft(e){return e===!0||e===!1||ki.call(e)==V}function mt(e){return e?"object"==typeof e&&ki.call(e)==$:!1}function _t(e){return e?1===e.nodeType:!1}function bt(e){var t=!0;if(!e)return t;var n=ki.call(e),i=e.length;return n==q||n==X||(Bi.argsClass?n==U:ut(e))||n==Q&&"number"==typeof i&&kt(e.splice)?!i:(Xi(e,function(){return t=!1}),t)}function vt(e,t,n,i,s,o){var a=n===w;if("function"==typeof n&&!a){n=r.createCallback(n,i,2);var u=n(e,t);if("undefined"!=typeof u)return!!u}if(e===t)return 0!==e||1/e==1/t;var c=typeof e,h=typeof t;if(e===e&&(!e||"function"!=c&&"object"!=c)&&(!t||"function"!=h&&"object"!=h))return!1;if(null==e||null==t)return e===t;var p=ki.call(e),f=ki.call(t);if(p==U&&(p=Q),f==U&&(f=Q),p!=f)return!1;switch(p){case V:case $:return+e==+t;case W:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case J:case X:return e==ni(t)}var m=p==q;if(!m){if(mi.call(e,"__wrapped__ ")||mi.call(t,"__wrapped__"))return vt(e.__wrapped__||e,t.__wrapped__||t,n,i,s,o);if(p!=Q||!Bi.nodeClass&&(d(e)||d(t)))return!1;var _=!Bi.argsObject&&ut(e)?ei:e.constructor,b=!Bi.argsObject&&ut(t)?ei:t.constructor;if(_!=b&&!(kt(_)&&_ instanceof _&&kt(b)&&b instanceof b))return!1}var v=!s;s||(s=l()),o||(o=l());for(var y=s.length;y--;)if(s[y]==e)return o[y]==t;var k=0;if(u=!0,s.push(e),o.push(t),m){if(y=e.length,k=t.length,u=k==e.length,!u&&!a)return u;for(;k--;){var N=y,E=t[k];if(a)for(;N--&&!(u=vt(e[N],E,n,i,s,o)););else if(!(u=vt(e[k],E,n,i,s,o)))break}return u}return Ji(t,function(t,r,a){return mi.call(a,r)?(k++,u=mi.call(e,r)&&vt(e[r],t,n,i,s,o)):void 0}),u&&!a&&Ji(e,function(e,t,n){return mi.call(n,t)?u=--k>-1:void 0}),v&&(g(s),g(o)),u}function yt(e){return Si(e)&&!xi(parseFloat(e))}function kt(e){return"function"==typeof e}function wt(e){return!(!e||!Z[typeof e])}function Nt(e){return St(e)&&e!=+e}function Et(e){return null===e}function St(e){return"number"==typeof e||ki.call(e)==W}function xt(e){return!(!e||!Z[typeof e])&&ki.call(e)==J}function Ct(e){return"string"==typeof e||ki.call(e)==X}function At(e){return"undefined"==typeof e}function It(e,t,n){var i=arguments,s=0,o=2;if(!wt(e))return e;if(n===w)var a=i[3],u=i[4],c=i[5];else{var d=!0;u=l(),c=l(),"number"!=typeof n&&(o=i.length),o>3&&"function"==typeof i[o-2]?a=r.createCallback(i[--o-1],i[o--],2):o>2&&"function"==typeof i[o-1]&&(a=i[--o])}for(;++s<o;)(Ui(i[s])?Ft:Xi)(i[s],function(t,n){var i,r,s=t,o=e[n];if(t&&((r=Ui(t))||Yi(t))){for(var l=u.length;l--;)if(i=u[l]==t){o=c[l];break}if(!i){var d;a&&(s=a(o,t),(d="undefined"!=typeof s)&&(o=s)),d||(o=r?Ui(o)?o:[]:Yi(o)?o:{}),u.push(t),c.push(o),d||(o=It(o,t,w,a,u,c))}}else a&&(s=a(o,t),"undefined"==typeof s&&(s=t)),"undefined"!=typeof s&&(o=s);e[n]=o});return d&&(g(u),g(c)),e}function Tt(e,t,n){var i=it(),s="function"==typeof t,o={};if(s)t=r.createCallback(t,n);else var a=hi.apply(ri,Oi.call(arguments,1));return Ji(e,function(e,n,r){(s?!t(e,n,r):i(a,n)<0)&&(o[n]=e)}),o}function Pt(e){for(var t=-1,n=Vi(e),i=n.length,r=Gn(i);++t<i;){var s=n[t];r[t]=[s,e[s]]}return r}function Ot(e,t,n){var i={};if("function"!=typeof t)for(var s=-1,o=hi.apply(ri,Oi.call(arguments,1)),a=wt(e)?o.length:0;++s<a;){var u=o[s];u in e&&(i[u]=e[u])}else t=r.createCallback(t,n),Ji(e,function(e,n,r){t(e,n,r)&&(i[n]=e)});return i}function Mt(e,t,n,i){var s=Ui(e);if(t=r.createCallback(t,i,4),null==n)if(s)n=[];else{var o=e&&e.constructor,a=o&&o.prototype;n=et(a)}return(s?$i:Xi)(e,function(e,i,r){return t(n,e,i,r)}),n}function Dt(e){for(var t=-1,n=Vi(e),i=n.length,r=Gn(i);++t<i;)r[t]=e[n[t]];return r}function Lt(e){var t=-1,n=hi.apply(ri,Oi.call(arguments,1)),i=n.length,r=Gn(i);for(Bi.unindexedChars&&Ct(e)&&(e=e.split(""));++t<i;)r[t]=e[n[t]];return r}function Rt(e,t,n){var i=-1,r=it(),s=e?e.length:0,o=!1;return n=(0>n?Ai(0,s+n):n)||0,s&&"number"==typeof s?o=(Ct(e)?e.indexOf(t,n):r(e,t,n))>-1:$i(e,function(e){return++i>=n?!(o=e===t):void 0}),o}function Bt(e,t,n){var i={};return t=r.createCallback(t,n),Ft(e,function(e,n,r){n=ni(t(e,n,r)),mi.call(i,n)?i[n]++:i[n]=1}),i}function jt(e,t,n){var i=!0;if(t=r.createCallback(t,n),Ui(e))for(var s=-1,o=e.length;++s<o&&(i=!!t(e[s],s,e)););else $i(e,function(e,n,r){return i=!!t(e,n,r)});return i}function Kt(e,t,n){var i=[];if(t=r.createCallback(t,n),Ui(e))for(var s=-1,o=e.length;++s<o;){var a=e[s];t(a,s,e)&&i.push(a)}else $i(e,function(e,n,r){t(e,n,r)&&i.push(e)});return i}function Ht(e,t,n){if(t=r.createCallback(t,n),!Ui(e)){var i;return $i(e,function(e,n,r){return t(e,n,r)?(i=e,!1):void 0}),i}for(var s=-1,o=e.length;++s<o;){var a=e[s];if(t(a,s,e))return a}}function Ft(e,t,n){if(t&&"undefined"==typeof n&&Ui(e))for(var i=-1,r=e.length;++i<r&&t(e[i],i,e)!==!1;);else $i(e,t,n);return e}function Ut(e,t,n){var i={};return t=r.createCallback(t,n),Ft(e,function(e,n,r){n=ni(t(e,n,r)),(mi.call(i,n)?i[n]:i[n]=[]).push(e)}),i}function qt(e,t){var n=Oi.call(arguments,2),i=-1,r="function"==typeof t,s=e?e.length:0,o=Gn("number"==typeof s?s:0);return Ft(e,function(e){o[++i]=(r?t:e[t]).apply(e,n)}),o}function Vt(e,t,n){var i=-1,s=e?e.length:0,o=Gn("number"==typeof s?s:0);if(t=r.createCallback(t,n),Ui(e))for(;++i<s;)o[i]=t(e[i],i,e);else $i(e,function(e,n,r){o[++i]=t(e,n,r)});return o}function $t(e,t,n){var i=-1/0,o=i;if(!t&&Ui(e))for(var a=-1,u=e.length;++a<u;){var l=e[a];l>o&&(o=l)}else t=!t&&Ct(e)?s:r.createCallback(t,n),$i(e,function(e,n,r){var s=t(e,n,r);s>i&&(i=s,o=e)});return o}function zt(e,t,n){var i=1/0,o=i;if(!t&&Ui(e))for(var a=-1,u=e.length;++a<u;){var l=e[a];o>l&&(o=l)}else t=!t&&Ct(e)?s:r.createCallback(t,n),$i(e,function(e,n,r){var s=t(e,n,r);i>s&&(i=s,o=e)});return o}function Gt(e,t,n,i){var s=arguments.length<3;if(t=r.createCallback(t,i,4),Ui(e)){var o=-1,a=e.length;for(s&&(n=e[++o]);++o<a;)n=t(n,e[o],o,e)}else $i(e,function(e,i,r){n=s?(s=!1,e):t(n,e,i,r)});return n}function Wt(e,t,n,i){var s=e,o=e?e.length:0,a=arguments.length<3;if("number"!=typeof o){var u=Vi(e);o=u.length}else Bi.unindexedChars&&Ct(e)&&(s=e.split(""));return t=r.createCallback(t,i,4),Ft(e,function(e,i,r){i=u?u[--o]:--o,n=a?(a=!1,s[i]):t(n,s[i],i,r)}),n}function Qt(e,t,n){return t=r.createCallback(t,n),Kt(e,function(e,n,i){return!t(e,n,i)})}function Jt(e){var t=-1,n=e?e.length:0,i=Gn("number"==typeof n?n:0);return Ft(e,function(e){var n=gi(Pi()*(++t+1));i[t]=i[n],i[n]=e}),i}function Xt(e){var t=e?e.length:0;return"number"==typeof t?t:Vi(e).length}function Yt(e,t,n){var i;if(t=r.createCallback(t,n),Ui(e))for(var s=-1,o=e.length;++s<o&&!(i=t(e[s],s,e)););else $i(e,function(e,n,r){return!(i=t(e,n,r))});return!!i}function Zt(e,t,n){var i=-1,s=e?e.length:0,a=Gn("number"==typeof s?s:0);for(t=r.createCallback(t,n),Ft(e,function(e,n,r){var s=a[++i]=c();s.criteria=t(e,n,r),s.index=i,s.value=e}),s=a.length,a.sort(o);s--;){var u=a[s];a[s]=u.value,p(u)}return a}function en(e){return e&&"number"==typeof e.length?Bi.unindexedChars&&Ct(e)?e.split(""):f(e):Dt(e)}function tn(e){for(var t=-1,n=e?e.length:0,i=[];++t<n;){var r=e[t];r&&i.push(r)}return i}function nn(e){var n=-1,r=it(),s=e?e.length:0,o=hi.apply(ri,Oi.call(arguments,1)),u=[],l=s>=E&&r===t;if(l){var c=a(o);c?(r=i,o=c):l=!1}for(;++n<s;){var d=e[n];r(o,d)<0&&u.push(d)}return l&&p(o),u}function rn(e,t,n){var i=-1,s=e?e.length:0;for(t=r.createCallback(t,n);++i<s;)if(t(e[i],i,e))return i;return-1}function sn(e,t,n){if(e){var i=0,s=e.length;if("number"!=typeof t&&null!=t){var o=-1;for(t=r.createCallback(t,n);++o<s&&t(e[o],o,e);)i++}else if(i=t,null==i||n)return e[0];return f(e,0,Ii(Ai(0,i),s))}}function on(e,n,i){if("number"==typeof i){var r=e?e.length:0;i=0>i?Ai(0,r+i):i||0}else if(i){var s=gn(e,n);return e[s]===n?s:-1}return e?t(e,n,i):-1}function an(e,t,n){if(!e)return[];var i=0,s=e.length;if("number"!=typeof t&&null!=t){var o=s;for(t=r.createCallback(t,n);o--&&t(e[o],o,e);)i++}else i=null==t||n?1:t||i;return f(e,0,Ii(Ai(0,s-i),s))}function un(e){for(var n=arguments,r=n.length,s=-1,o=l(),u=-1,c=it(),d=e?e.length:0,h=[],f=l();++s<r;){var m=n[s];o[s]=c===t&&(m?m.length:0)>=E&&a(s?n[s]:f)}e:for(;++u<d;){var _=o[0];if(m=e[u],(_?i(_,m):c(f,m))<0){for(s=r,(_||f).push(m);--s;)if(_=o[s],(_?i(_,m):c(n[s],m))<0)continue e;h.push(m)}}for(;r--;)_=o[r],_&&p(_);return g(o),g(f),h}function ln(e,t,n){if(e){var i=0,s=e.length;if("number"!=typeof t&&null!=t){var o=s;for(t=r.createCallback(t,n);o--&&t(e[o],o,e);)i++}else if(i=t,null==i||n)return e[s-1];return f(e,Ai(0,s-i))}}function cn(e,t,n){var i=e?e.length:0;for("number"==typeof n&&(i=(0>n?Ai(0,i+n):Ii(n,i-1))+1);i--;)if(e[i]===t)return i;return-1}function dn(e,t,n){e=+e||0,n=+n||1,null==t&&(t=e,e=0);for(var i=-1,r=Ai(0,ci((t-e)/n)),s=Gn(r);++i<r;)s[i]=e,e+=n;return s}function hn(e,t,n){if("number"!=typeof t&&null!=t){var i=0,s=-1,o=e?e.length:0;for(t=r.createCallback(t,n);++s<o&&t(e[s],s,e);)i++}else i=null==t||n?1:Ai(0,t);return f(e,i)}function gn(e,t,n,i){var s=0,o=e?e.length:s;for(n=n?r.createCallback(n,i,1):Ln,t=n(t);o>s;){var a=s+o>>>1;n(e[a])<t?s=a+1:o=a}return s}function pn(e){return Ui(e)||(arguments[0]=e?Oi.call(e):ri),nr(hi.apply(ri,arguments))}function fn(e){for(var t=-1,n=e?$t(Zi(e,"length")):0,i=Gn(0>n?0:n);++t<n;)i[t]=Zi(e,t);return i}function mn(e){return nn(e,Oi.call(arguments,1))}function _n(e){return e?fn(arguments):[]}function bn(e,t){for(var n=-1,i=e?e.length:0,r={};++n<i;){var s=e[n];t?r[s]=t[n]:r[s[0]]=s[1]}return r}function vn(e,t){return 1>e?t():function(){return--e<1?t.apply(this,arguments):void 0}}function yn(e,t){return Bi.fastBind||wi&&arguments.length>2?wi.call.apply(wi,arguments):v(e,t,Oi.call(arguments,2))}function kn(e){for(var t=arguments.length>1?hi.apply(ri,Oi.call(arguments,1)):ht(e),n=-1,i=t.length;++n<i;){var r=t[n];e[r]=yn(e[r],e)}return e}function wn(e,t){return v(e,t,Oi.call(arguments,2),w)}function Nn(){var e=arguments;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}}function En(e,t,n){if(null==e)return Ln;var i=typeof e;if("function"!=i){if("object"!=i)return function(t){return t[e]};var r=Vi(e);return function(t){for(var n=r.length,i=!1;n--&&(i=vt(t[r[n]],e[r[n]],w)););return i}}return"undefined"==typeof t||M&&!M.test(pi.call(e))?e:1===n?function(n){return e.call(t,n)}:2===n?function(n,i){return e.call(t,n,i)}:4===n?function(n,i,r,s){return e.call(t,n,i,r,s)}:function(n,i,r){return e.call(t,n,i,r)}}function Sn(e,t,n){function i(){di(h),di(g),l=0,h=g=null}function r(){var t=p&&(!f||l>1);i(),t&&(d!==!1&&(c=new Qn),a=e.apply(u,o))}function s(){i(),(p||d!==t)&&(c=new Qn,a=e.apply(u,o))}var o,a,u,l=0,c=0,d=!1,h=null,g=null,p=!0;if(t=Ai(0,t||0),n===!0){var f=!0;p=!1}else wt(n)&&(f=n.leading,d="maxWait"in n&&Ai(t,n.maxWait||0),p="trailing"in n?n.trailing:p);return function(){if(o=arguments,u=this,l++,di(g),d===!1)f&&2>l&&(a=e.apply(u,o));else{var n=new Qn;h||f||(c=n);var i=d-(n-c);0>=i?(di(h),h=null,c=n,a=e.apply(u,o)):h||(h=yi(s,i))}return t!==d&&(g=yi(r,t)),a}}function xn(e){var t=Oi.call(arguments,1);return yi(function(){e.apply(_,t)},1)}function Cn(e,t){var n=Oi.call(arguments,2);return yi(function(){e.apply(_,n)},t)}function An(e,t){function n(){var i=n.cache,r=N+(t?t.apply(this,arguments):arguments[0]);return mi.call(i,r)?i[r]:i[r]=e.apply(this,arguments)}return n.cache={},n}function In(e){var t,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function Tn(e){return v(e,Oi.call(arguments,1))}function Pn(e){return v(e,Oi.call(arguments,1),null,w)}function On(e,t,n){var i=!0,r=!0;n===!1?i=!1:wt(n)&&(i="leading"in n?n.leading:i,r="trailing"in n?n.trailing:r),n=c(),n.leading=i,n.maxWait=t,n.trailing=r;var s=Sn(e,t,n);return p(n),s}function Mn(e,t){return function(){var n=[e];return _i.apply(n,arguments),t.apply(this,n)}}function Dn(e){return null==e?"":ni(e).replace(B,tt)}function Ln(e){return e}function Rn(e){Ft(ht(e),function(t){var n=r[t]=e[t];r.prototype[t]=function(){var e=this.__wrapped__,t=[e];_i.apply(t,arguments);var i=n.apply(r,t);return e&&"object"==typeof e&&e===i?this:new b(i)}})}function Bn(){return n._=ui,this}function jn(e,t){null==e&&null==t&&(t=1),e=+e||0,null==t?(t=e,e=0):t=+t||0;var n=Pi();return e%1||t%1?e+Ii(n*(t-e+parseFloat("1e-"+((n+"").length-1))),t):e+gi(n*(t-e+1))}function Kn(e,t){var n=e?e[t]:_;return kt(n)?e[t]():n}function Hn(e,t,n){var i=r.templateSettings;e||(e=""),n=Qi({},n,i);var s,o=Qi({},n.imports,i.imports),a=Vi(o),l=Dt(o),c=0,d=n.interpolate||R,h="__p += '",g=ti((n.escape||R).source+"|"+d.source+"|"+(d===O?T:R).source+"|"+(n.evaluate||R).source+"|$","g");e.replace(g,function(t,n,i,r,o,a){return i||(i=r),h+=e.slice(c,a).replace(j,u),n&&(h+="' +\n__e("+n+") +\n'"),o&&(s=!0,h+="';\n"+o+";\n__p += '"),i&&(h+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),c=a+t.length,t}),h+="';\n";var p=n.variable,f=p;f||(p="obj",h="with ("+p+") {\n"+h+"\n}\n"),h=(s?h.replace(x,""):h).replace(C,"$1").replace(A,"$1;"),h="function("+p+") {\n"+(f?"":p+" || ("+p+" = {});\n")+"var __t, __p = '', __e = _.escape"+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var m="\n/*\n//@ sourceURL="+(n.sourceURL||"/lodash/template/source["+F++ +"]")+"\n*/";try{var b=Xn(a,"return "+h+m).apply(_,l)}catch(v){throw v.source=h,v}return t?b(t):(b.source=h,b)}function Fn(e,t,n){e=(e=+e)>-1?e:0;var i=-1,s=Gn(e);for(t=r.createCallback(t,n,1);++i<e;)s[i]=t(i);return s}function Un(e){return null==e?"":ni(e).replace(I,at)}function qn(e){var t=++y;return ni(null==e?"":e)+t}function Vn(e,t){return t(e),e}function $n(){return ni(this.__wrapped__)}function zn(){return this.__wrapped__}n=n?rt.defaults(e.Object(),n,rt.pick(e,K)):e;var Gn=n.Array,Wn=n.Boolean,Qn=n.Date,Jn=n.Error,Xn=n.Function,Yn=n.Math,Zn=n.Number,ei=n.Object,ti=n.RegExp,ni=n.String,ii=n.TypeError,ri=[],si=Jn.prototype,oi=ei.prototype,ai=ni.prototype,ui=n._,li=ti("^"+ni(oi.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),ci=Yn.ceil,di=n.clearTimeout,hi=ri.concat,gi=Yn.floor,pi=Xn.prototype.toString,fi=li.test(fi=ei.getPrototypeOf)&&fi,mi=oi.hasOwnProperty,_i=ri.push,bi=oi.propertyIsEnumerable,vi=n.setImmediate,yi=n.setTimeout,ki=oi.toString,wi=li.test(wi=ki.bind)&&wi,Ni=li.test(Ni=ei.create)&&Ni,Ei=li.test(Ei=Gn.isArray)&&Ei,Si=n.isFinite,xi=n.isNaN,Ci=li.test(Ci=ei.keys)&&Ci,Ai=Yn.max,Ii=Yn.min,Ti=n.parseInt,Pi=Yn.random,Oi=ri.slice,Mi=li.test(n.attachEvent),Di=wi&&!/\n|true/.test(wi+Mi),Li={};Li[q]=Gn,Li[V]=Wn,Li[$]=Qn,Li[G]=Xn,Li[Q]=ei,Li[W]=Zn,Li[J]=ti,Li[X]=ni;var Ri={};Ri[q]=Ri[$]=Ri[W]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},Ri[V]=Ri[X]={constructor:!0,toString:!0,valueOf:!0},Ri[z]=Ri[G]=Ri[J]={constructor:!0,toString:!0},Ri[Q]={constructor:!0},function(){for(var e=H.length;e--;){var t=H[e];for(var n in Ri)mi.call(Ri,n)&&!mi.call(Ri[n],t)&&(Ri[n][t]=!1)}}(),b.prototype=r.prototype;var Bi=r.support={};!function(){var e=function(){this.x=1},t={0:1,length:1},n=[];e.prototype={valueOf:1,y:1};for(var i in new e)n.push(i);for(i in arguments);Bi.argsObject=arguments.constructor==ei&&!(arguments instanceof Gn),Bi.argsClass=ut(arguments),Bi.enumErrorProps=bi.call(si,"message")||bi.call(si,"name"),Bi.enumPrototypes=bi.call(e,"prototype"),Bi.fastBind=wi&&!Di,Bi.ownLast="x"!=n[0],Bi.nonEnumArgs=0!=i,Bi.nonEnumShadows=!/valueOf/.test(n),Bi.spliceObjects=(ri.splice.call(t,0,1),!t[0]),Bi.unindexedChars="xx"!="x"[0]+ei("x")[0];try{Bi.nodeClass=!(ki.call(document)==Q&&!({toString:0}+""))}catch(r){Bi.nodeClass=!0}}(1),r.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:O,variable:"",imports:{_:r}};var ji=function(e){var t="var index, iterable = "+e.firstArg+", result = "+e.init+";\nif (!iterable) return result;\n"+e.top+";";e.array?(t+="\nvar length = iterable.length; index = -1;\nif ("+e.array+") {  ",Bi.unindexedChars&&(t+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),t+="\n  while (++index < length) {\n    "+e.loop+";\n  }\n}\nelse {  "):Bi.nonEnumArgs&&(t+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+e.loop+";\n    }\n  } else {  "),Bi.enumPrototypes&&(t+="\n  var skipProto = typeof iterable == 'function';\n  "),Bi.enumErrorProps&&(t+="\n  var skipErrorProps = iterable === errorProto || iterable instanceof Error;\n  ");var n=[];if(Bi.enumPrototypes&&n.push('!(skipProto && index == "prototype")'),Bi.enumErrorProps&&n.push('!(skipErrorProps && (index == "message" || index == "name"))'),e.useHas&&e.useKeys)t+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] && keys(iterable),\n      length = ownProps ? ownProps.length : 0;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n",n.length&&(t+="    if ("+n.join(" && ")+") {\n  "),t+=e.loop+";    ",n.length&&(t+="\n    }"),t+="\n  }  ";else if(t+="\n  for (index in iterable) {\n",e.useHas&&n.push("hasOwnProperty.call(iterable, index)"),n.length&&(t+="    if ("+n.join(" && ")+") {\n  "),t+=e.loop+";    ",n.length&&(t+="\n    }"),t+="\n  }    ",Bi.nonEnumShadows){for(t+="\n\n  if (iterable !== objectProto) {\n    var ctor = iterable.constructor,\n        isProto = iterable === (ctor && ctor.prototype),\n        className = iterable === stringProto ? stringClass : iterable === errorProto ? errorClass : toString.call(iterable),\n        nonEnum = nonEnumProps[className];\n      ",k=0;7>k;k++)t+="\n    index = '"+e.shadowedProps[k]+"';\n    if ((!(isProto && nonEnum[index]) && hasOwnProperty.call(iterable, index))",e.useHas||(t+=" || (!nonEnum[index] && iterable[index] !== objectProto[index])"),t+=") {\n      "+e.loop+";\n    }      ";t+="\n  }    "}return(e.array||Bi.nonEnumArgs)&&(t+="\n}"),t+=e.bottom+";\nreturn result"},Ki={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},Hi={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : lodash.createCallback(callback, thisArg)",array:"typeof length == 'number'",loop:"if (callback(iterable[index], index, collection) === false) return result"},Fi={top:"if (!objectTypes[typeof iterable]) return result;\n"+Hi.top,array:!1};if(!Ni)var et=function(e){if(wt(e)){h.prototype=e;var t=new h;h.prototype=null}return t||{}};Bi.argsClass||(ut=function(e){return e?mi.call(e,"callee"):!1});var Ui=Ei||function(e){return e?"object"==typeof e&&ki.call(e)==q:!1},qi=S({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)"}),Vi=Ci?function(e){return wt(e)?Bi.enumPrototypes&&"function"==typeof e||Bi.nonEnumArgs&&e.length&&ut(e)?qi(e):Ci(e):[]}:qi,$i=S(Hi),zi={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Gi=pt(zi),Wi=S(Ki,{top:Ki.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = lodash.createCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),Qi=S(Ki),Ji=S(Hi,Fi,{useHas:!1}),Xi=S(Hi,Fi);kt(/x/)&&(kt=function(e){return"function"==typeof e&&ki.call(e)==G});var Yi=fi?function(e){if(!e||ki.call(e)!=Q||!Bi.argsClass&&ut(e))return!1;var t=e.valueOf,n="function"==typeof t&&(n=fi(t))&&fi(n);return n?e==n||fi(e)==n:ot(e)}:ot,Zi=Vt,er=Kt,tr=st(function rr(e,t,n){for(var i=-1,r=e?e.length:0,s=[];++i<r;){var o=e[i];n&&(o=n(o,i,e)),Ui(o)?_i.apply(s,t?o:rr(o)):s.push(o)}return s}),nr=st(function(e,n,r){var s=-1,o=it(),u=e?e.length:0,c=[],d=!n&&u>=E&&o===t,h=r||d?l():c;if(d){var f=a(h);f?(o=i,h=f):(d=!1,h=r?h:(g(h),c))}for(;++s<u;){var m=e[s],_=r?r(m,s,e):m;(n?!s||h[h.length-1]!==_:o(h,_)<0)&&((r||d)&&h.push(_),c.push(m))}return d?(g(h.array),p(h)):r&&g(h),c});Di&&nt&&"function"==typeof vi&&(xn=yn(vi,n));var ir=8==Ti(D+"08")?Ti:function(e,t){return Ti(Ct(e)?e.replace(L,""):e,t||0)};return r.after=vn,r.assign=Wi,r.at=Lt,r.bind=yn,r.bindAll=kn,r.bindKey=wn,r.compact=tn,r.compose=Nn,r.countBy=Bt,r.createCallback=En,r.debounce=Sn,r.defaults=Qi,r.defer=xn,r.delay=Cn,r.difference=nn,r.filter=Kt,r.flatten=tr,r.forEach=Ft,r.forIn=Ji,r.forOwn=Xi,r.functions=ht,r.groupBy=Ut,r.initial=an,r.intersection=un,r.invert=pt,r.invoke=qt,r.keys=Vi,r.map=Vt,r.max=$t,r.memoize=An,r.merge=It,r.min=zt,r.omit=Tt,r.once=In,r.pairs=Pt,r.partial=Tn,r.partialRight=Pn,r.pick=Ot,r.pluck=Zi,r.range=dn,r.reject=Qt,r.rest=hn,r.shuffle=Jt,r.sortBy=Zt,r.tap=Vn,r.throttle=On,r.times=Fn,r.toArray=en,r.transform=Mt,r.union=pn,r.uniq=nr,r.unzip=fn,r.values=Dt,r.where=er,r.without=mn,r.wrap=Mn,r.zip=_n,r.zipObject=bn,r.collect=Vt,r.drop=hn,r.each=Ft,r.extend=Wi,r.methods=ht,r.object=bn,r.select=Kt,r.tail=hn,r.unique=nr,Rn(r),r.chain=r,r.prototype.chain=function(){return this
},r.clone=lt,r.cloneDeep=ct,r.contains=Rt,r.escape=Dn,r.every=jt,r.find=Ht,r.findIndex=rn,r.findKey=dt,r.has=gt,r.identity=Ln,r.indexOf=on,r.isArguments=ut,r.isArray=Ui,r.isBoolean=ft,r.isDate=mt,r.isElement=_t,r.isEmpty=bt,r.isEqual=vt,r.isFinite=yt,r.isFunction=kt,r.isNaN=Nt,r.isNull=Et,r.isNumber=St,r.isObject=wt,r.isPlainObject=Yi,r.isRegExp=xt,r.isString=Ct,r.isUndefined=At,r.lastIndexOf=cn,r.mixin=Rn,r.noConflict=Bn,r.parseInt=ir,r.random=jn,r.reduce=Gt,r.reduceRight=Wt,r.result=Kn,r.runInContext=m,r.size=Xt,r.some=Yt,r.sortedIndex=gn,r.template=Hn,r.unescape=Un,r.uniqueId=qn,r.all=jt,r.any=Yt,r.detect=Ht,r.findWhere=Ht,r.foldl=Gt,r.foldr=Wt,r.include=Rt,r.inject=Gt,Xi(r,function(e,t){r.prototype[t]||(r.prototype[t]=function(){var t=[this.__wrapped__];return _i.apply(t,arguments),e.apply(r,t)})}),r.first=sn,r.last=ln,r.take=sn,r.head=sn,Xi(r,function(e,t){r.prototype[t]||(r.prototype[t]=function(t,n){var i=e(this.__wrapped__,t,n);return null==t||n&&"function"!=typeof t?i:new b(i)})}),r.VERSION="1.3.1",r.prototype.toString=$n,r.prototype.value=zn,r.prototype.valueOf=zn,$i(["join","pop","shift"],function(e){var t=ri[e];r.prototype[e]=function(){return t.apply(this.__wrapped__,arguments)}}),$i(["push","reverse","sort","unshift"],function(e){var t=ri[e];r.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),$i(["concat","slice","splice"],function(e){var t=ri[e];r.prototype[e]=function(){return new b(t.apply(this.__wrapped__,arguments))}}),Bi.spliceObjects||$i(["pop","shift","splice"],function(e){var t=ri[e],n="splice"==e;r.prototype[e]=function(){var e=this.__wrapped__,i=t.apply(e,arguments);return 0===e.length&&delete e[0],n?new b(i):i}}),r}var _,b=[],v=[],y=0,w={},N=+new Date+"",E=75,S=40,x=/\b__p \+= '';/g,C=/\b(__p \+=) '' \+/g,A=/(__e\(.*?\)|\b__t\)) \+\n'';/g,I=/&(?:amp|lt|gt|quot|#39);/g,T=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,P=/\w*$/,O=/<%=([\s\S]+?)%>/g,M=(M=/\bthis\b/)&&M.test(m)&&M,D=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",L=RegExp("^["+D+"]*0+(?=.$)"),R=/($^)/,B=/[&<>"']/g,j=/['\n\r\t\u2028\u2029\\]/g,K=["Array","Boolean","Date","Error","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],H=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],F=0,U="[object Arguments]",q="[object Array]",V="[object Boolean]",$="[object Date]",z="[object Error]",G="[object Function]",W="[object Number]",Q="[object Object]",J="[object RegExp]",X="[object String]",Y={};Y[G]=!1,Y[U]=Y[q]=Y[V]=Y[$]=Y[W]=Y[Q]=Y[J]=Y[X]=!0;var Z={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},et={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},tt=Z[typeof exports]&&exports,nt=Z[typeof module]&&module&&module.exports==tt&&module,it=Z[typeof global]&&global;!it||it.global!==it&&it.window!==it||(e=it);var rt=m();"function"==typeof n&&"object"==typeof n.amd&&n.amd?(e._=rt,n("lib/lodash",[],function(){return rt})):tt&&!tt.nodeType?nt?(nt.exports=rt)._=rt:tt._=rt:e._=rt}(this),n("gd-sdk/config",{apiKey:null,sdkFrameKey:null,api:{frameOrigin:null,clientOrigin:null,sdkFramePath:"/apis/plugins/sdk-frame",sdkBootstrapPath:"/apis/plugins/sdk/bootstrap",publicSharedCallbackPath:"/plugins/social/public/{network}/shared?url={url}",personalSharedCallbackPath:"/plugins/social/personal/{network}/shared?url={url}",viewMetricsPath:"/apis/relevance/metrics",viewMetricsEnvironmentPath:"/apis/relevance/environment",pluginEventsPath:"/apis/plugins/events",sessionKeyHeader:"x-ihq-session-id"},sdk:{devFlag:"ihqDebug",devSimulateConsoleFlag:"ihqDebugSimulateConsole",shareRef:"gdRef",devHost:"localhost.gd:1337",attrs:{prefix:"data-gd-",ignored:["plugin","plugin-loading","started","bar-items"],sandbox:"allow-same-origin allow-scripts"},stylesheets:["/css/gd.min.css"],debugStylesheets:["/css/gd.css"],storage:{sdkKey:"gdSDK",userDataKey:"userData",sessionKey:"sessionKey",persistUserDataAcrossSessions:!1}},user:{loggedIn:!1,info:{}},features:{pluginsBlackList:""},pluginList:{plugins:{},groups:{}}}),function(e,t,i){"undefined"!=typeof module&&module.exports?module.exports=i():"function"==typeof n&&n.amd?n("lib/bean",i):t[e]=i()}("bean",this,function(e,t){e=e||"bean",t=t||this;var n,i=window,r=t[e],s=/[^\.]*(?=\..*)\.|.*/,o=/\..*/,a="addEventListener",u="removeEventListener",l=document||{},c=l.documentElement||{},d=c[a],h=d?a:"attachEvent",g={},p=Array.prototype.slice,f=function(e,t){return e.split(t||" ")},m=function(e){return"string"==typeof e},_=function(e){return"function"==typeof e},b="click dblclick mouseup mousedown contextmenu mousewheel mousemultiwheel DOMMouseScroll mouseover mouseout mousemove selectstart selectend keydown keypress keyup orientationchange focus blur change reset select submit load unload beforeunload resize move DOMContentLoaded readystatechange message error abort scroll ",v="show input invalid touchstart touchmove touchend touchcancel gesturestart gesturechange gestureend textinputreadystatechange pageshow pagehide popstate hashchange offline online afterprint beforeprint dragstart dragenter dragover dragleave drag drop dragend loadstart progress suspend emptied stalled loadmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate play pause ratechange volumechange cuechange checking noupdate downloading cached updateready obsolete ",y=function(e,t,n){for(n=0;n<t.length;n++)t[n]&&(e[t[n]]=1);return e}({},f(b+(d?v:""))),k=function(){var e="compareDocumentPosition"in c?function(e,t){return t.compareDocumentPosition&&16===(16&t.compareDocumentPosition(e))}:"contains"in c?function(e,t){return t=9===t.nodeType||t===window?c:t,t!==e&&t.contains(e)}:function(e,t){for(;e=e.parentNode;)if(e===t)return 1;return 0},t=function(t){var n=t.relatedTarget;return n?n!==this&&"xul"!==n.prefix&&!/document/.test(this.toString())&&!e(n,this):null==n};return{mouseenter:{base:"mouseover",condition:t},mouseleave:{base:"mouseout",condition:t},mousewheel:{base:/Firefox/.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel"}}}(),w=function(){var e=f("altKey attrChange attrName bubbles cancelable ctrlKey currentTarget detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey srcElement target timeStamp type view which propertyName"),t=e.concat(f("button buttons clientX clientY dataTransfer fromElement offsetX offsetY pageX pageY screenX screenY toElement")),n=t.concat(f("wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ axis")),r=e.concat(f("char charCode key keyCode keyIdentifier keyLocation location")),s=e.concat(f("data")),o=e.concat(f("touches targetTouches changedTouches scale rotation")),a=e.concat(f("data origin source")),u=e.concat(f("state")),d=/over|out/,h=[{reg:/key/i,fix:function(e,t){return t.keyCode=e.keyCode||e.which,r}},{reg:/click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i,fix:function(e,n,i){return n.rightClick=3===e.which||2===e.button,n.pos={x:0,y:0},e.pageX||e.pageY?(n.clientX=e.pageX,n.clientY=e.pageY):(e.clientX||e.clientY)&&(n.clientX=e.clientX+l.body.scrollLeft+c.scrollLeft,n.clientY=e.clientY+l.body.scrollTop+c.scrollTop),d.test(i)&&(n.relatedTarget=e.relatedTarget||e[("mouseover"==i?"from":"to")+"Element"]),t}},{reg:/mouse.*(wheel|scroll)/i,fix:function(){return n}},{reg:/^text/i,fix:function(){return s}},{reg:/^touch|^gesture/i,fix:function(){return o}},{reg:/^message$/i,fix:function(){return a}},{reg:/^popstate$/i,fix:function(){return u}},{reg:/.*/,fix:function(){return e}}],g={},p=function(e,t,n){if(arguments.length&&(e=e||((t.ownerDocument||t.document||t).parentWindow||i).event,this.originalEvent=e,this.isNative=n,this.isBean=!0,e)){var r,s,o,a,u,l=e.type,c=e.target||e.srcElement;if(this.target=c&&3===c.nodeType?c.parentNode:c,n){if(u=g[l],!u)for(r=0,s=h.length;s>r;r++)if(h[r].reg.test(l)){g[l]=u=h[r].fix;break}for(a=u(e,this,l),r=a.length;r--;)!((o=a[r])in this)&&o in e&&(this[o]=e[o])}}};return p.prototype.preventDefault=function(){this.originalEvent.preventDefault?this.originalEvent.preventDefault():this.originalEvent.returnValue=!1},p.prototype.stopPropagation=function(){this.originalEvent.stopPropagation?this.originalEvent.stopPropagation():this.originalEvent.cancelBubble=!0},p.prototype.stop=function(){this.preventDefault(),this.stopPropagation(),this.stopped=!0},p.prototype.stopImmediatePropagation=function(){this.originalEvent.stopImmediatePropagation&&this.originalEvent.stopImmediatePropagation(),this.isImmediatePropagationStopped=function(){return!0}},p.prototype.isImmediatePropagationStopped=function(){return this.originalEvent.isImmediatePropagationStopped&&this.originalEvent.isImmediatePropagationStopped()},p.prototype.clone=function(e){var t=new p(this,this.element,this.isNative);return t.currentTarget=e,t},p}(),N=function(e,t){return d||t||e!==l&&e!==i?e:c},E=function(){var e=function(e,t,n,i){var r=function(n,r){return t.apply(e,i?p.call(r,n?0:1).concat(i):r)},s=function(n,i){return t.__beanDel?t.__beanDel.ft(n.target,e):i},o=n?function(e){var t=s(e,this);return n.apply(t,arguments)?(e&&(e.currentTarget=t),r(e,arguments)):void 0}:function(e){return t.__beanDel&&(e=e.clone(s(e))),r(e,arguments)};return o.__beanDel=t.__beanDel,o},t=function(t,n,i,r,s,o,a){var u,l=k[n];"unload"==n&&(i=I(T,t,n,i,r)),l&&(l.condition&&(i=e(t,i,l.condition,o)),n=l.base||n),this.isNative=u=y[n]&&!!t[h],this.customType=!d&&!u&&n,this.element=t,this.type=n,this.original=r,this.namespaces=s,this.eventType=d||u?n:"propertychange",this.target=N(t,u),this[h]=!!this.target[h],this.root=a,this.handler=e(t,i,null,o)};return t.prototype.inNamespaces=function(e){var t,n,i=0;if(!e)return!0;if(!this.namespaces)return!1;for(t=e.length;t--;)for(n=this.namespaces.length;n--;)e[t]==this.namespaces[n]&&i++;return e.length===i},t.prototype.matches=function(e,t,n){return!(this.element!==e||t&&this.original!==t||n&&this.handler!==n)},t}(),S=function(){var e={},t=function(n,i,r,s,o,a){var u=o?"r":"$";if(i&&"*"!=i){var l,c=0,d=e[u+i],h="*"==n;if(!d)return;for(l=d.length;l>c;c++)if((h||d[c].matches(n,r,s))&&!a(d[c],d,c,i))return}else for(var g in e)g.charAt(0)==u&&t(n,g.substr(1),r,s,o,a)},n=function(t,n,i,r){var s,o=e[(r?"r":"$")+n];if(o)for(s=o.length;s--;)if(!o[s].root&&o[s].matches(t,i,null))return!0;return!1},i=function(e,n,i,r){var s=[];return t(e,n,i,null,r,function(e){return s.push(e)}),s},r=function(t){var n=!t.root&&!this.has(t.element,t.type,null,!1),i=(t.root?"r":"$")+t.type;return(e[i]||(e[i]=[])).push(t),n},s=function(n){t(n.element,n.type,null,n.handler,n.root,function(t,n,i){return n.splice(i,1),t.removed=!0,0===n.length&&delete e[(t.root?"r":"$")+t.type],!1})},o=function(){var t,n=[];for(t in e)"$"==t.charAt(0)&&(n=n.concat(e[t]));return n};return{has:n,get:i,put:r,del:s,entries:o}}(),x=function(e){n=arguments.length?e:l.querySelectorAll?function(e,t){return t.querySelectorAll(e)}:function(){throw new Error("Bean: No selector engine installed")}},C=function(e,t){if(d||!t||!e||e.propertyName=="_on"+t){var n=S.get(this,t||e.type,null,!1),i=n.length,r=0;for(e=new w(e,this,!0),t&&(e.type=t);i>r&&!e.isImmediatePropagationStopped();r++)n[r].removed||n[r].handler.call(this,e)}},A=d?function(e,t,n){e[n?a:u](t,C,!1)}:function(e,t,n,i){var r;n?(S.put(r=new E(e,i||t,function(t){C.call(e,t,i)},C,null,null,!0)),i&&null==e["_on"+i]&&(e["_on"+i]=0),r.target.attachEvent("on"+r.eventType,r.handler)):(r=S.get(e,i||t,C,!0)[0],r&&(r.target.detachEvent("on"+r.eventType,r.handler),S.del(r)))},I=function(e,t,n,i,r){return function(){i.apply(this,arguments),e(t,n,r)}},T=function(e,t,n,i){var r,s,a=t&&t.replace(o,""),u=S.get(e,a,null,!1),l={};for(r=0,s=u.length;s>r;r++)n&&u[r].original!==n||!u[r].inNamespaces(i)||(S.del(u[r]),!l[u[r].eventType]&&u[r][h]&&(l[u[r].eventType]={t:u[r].eventType,c:u[r].type}));for(r in l)S.has(e,l[r].t,null,!1)||A(e,l[r].t,!1,l[r].c)},P=function(e,t){var i=function(t,i){for(var r,s=m(e)?n(e,i):e;t&&t!==i;t=t.parentNode)for(r=s.length;r--;)if(s[r]===t)return t},r=function(e){var n=i(e.target,this);n&&t.apply(n,arguments)};return r.__beanDel={ft:i,selector:e},r},O=d?function(e,t,n){var r=l.createEvent(e?"HTMLEvents":"UIEvents");r[e?"initEvent":"initUIEvent"](t,!0,!0,i,1),n.dispatchEvent(r)}:function(e,t,n){n=N(n,e),e?n.fireEvent("on"+t,l.createEventObject()):n["_on"+t]++},M=function(e,t,n){var i,r,a,u,l=m(t);if(l&&t.indexOf(" ")>0){for(t=f(t),u=t.length;u--;)M(e,t[u],n);return e}if(r=l&&t.replace(o,""),r&&k[r]&&(r=k[r].base),!t||l)(a=l&&t.replace(s,""))&&(a=f(a,".")),T(e,r,n,a);else if(_(t))T(e,null,t);else for(i in t)t.hasOwnProperty(i)&&M(e,i,t[i]);return e},D=function(e,t,i,r){var a,u,l,c,d,m,b;{if(void 0!==i||"object"!=typeof t){for(_(i)?(d=p.call(arguments,3),r=a=i):(a=r,d=p.call(arguments,4),r=P(i,a,n)),l=f(t),this===g&&(r=I(M,e,t,r,a)),c=l.length;c--;)b=S.put(m=new E(e,l[c].replace(o,""),r,a,f(l[c].replace(s,""),"."),d,!1)),m[h]&&b&&A(e,m.eventType,!0,m.customType);return e}for(u in t)t.hasOwnProperty(u)&&D.call(this,e,u,t[u])}},L=function(e,t,n,i){return D.apply(null,m(n)?[e,n,t,i].concat(arguments.length>3?p.call(arguments,5):[]):p.call(arguments))},R=function(){return D.apply(g,arguments)},B=function(e,t,n){var i,r,a,u,l,c=f(t);for(i=c.length;i--;)if(t=c[i].replace(o,""),(u=c[i].replace(s,""))&&(u=f(u,".")),u||n||!e[h])for(l=S.get(e,t,null,!1),n=[!1].concat(n),r=0,a=l.length;a>r;r++)l[r].inNamespaces(u)&&l[r].handler.apply(e,n);else O(y[t],t,e);return e},j=function(e,t,n){for(var i,r,s=S.get(t,n,null,!1),o=s.length,a=0;o>a;a++)s[a].original&&(i=[e,s[a].type],(r=s[a].handler.__beanDel)&&i.push(r.selector),i.push(s[a].original),D.apply(null,i));return e},K={on:D,add:L,one:R,off:M,remove:M,clone:j,fire:B,Event:w,setSelectorEngine:x,noConflict:function(){return t[e]=r,this}};if(i.attachEvent){var H=function(){var e,t=S.entries();for(e in t)t[e].type&&"unload"!==t[e].type&&M(t[e].element,t[e].type);i.detachEvent("onunload",H),i.CollectGarbage&&i.CollectGarbage()};i.attachEvent("onunload",H)}return x(),K}),function(){function e(e){var t,n=(e.length+8>>6)+1,i=[];for(t=0;16*n>t;t++)i[t]=0;for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<24-8*(3&t);return i[t>>2]|=128<<24-8*(3&t),i[16*n-1]=8*e.length,i}function t(e){var t,n="0123456789abcdef",i="";for(t=0;t<4*e.length;t++)i+=n.charAt(15&e[t>>2]>>8*(3-t%4)+4)+n.charAt(15&e[t>>2]>>8*(3-t%4));return i}function i(e){var t,n,i,u,l,c,d,h,g=[],p=1732584193,f=4023233417,m=2562383102,_=271733878,b=3285377520;for(d=0;d<e.length;d+=16){for(t=p,n=f,i=m,u=_,l=b,h=0;80>h;h++)g[h]=16>h?e[d+h]:a(g[h-3]^g[h-8]^g[h-14]^g[h-16],1),c=o(o(a(p,5),r(h,f,m,_)),o(o(b,g[h]),s(h))),b=_,_=m,m=a(f,30),f=p,p=c;p=o(p,t),f=o(f,n),m=o(m,i),_=o(_,u),b=o(b,l)}return[p,f,m,_,b]}function r(e,t,n,i){return 20>e?t&n|~t&i:40>e?t^n^i:60>e?t&n|t&i|n&i:t^n^i}function s(e){return 20>e?1518500249:40>e?1859775393:60>e?2400959708:3395469782}function o(e,t){var n=(65535&e)+(65535&t),i=(e>>16)+(t>>16)+(n>>16);return i<<16|65535&n}function a(e,t){return e<<t|e>>>32-t}function u(n){return t(i(e(n)))}var l=this;"function"==typeof n?n("lib/sha1",[],function(){return u}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=u),exports.sha1=u):l.sha1=u}.call(this),n("gd-sdk/utils",["lib/p","lib/lodash","gd-sdk/config"],function(e,t,n){function i(){var e=r.getSdkOrigin(),t=/:\/\/([^.]+)/,n=e.match(t);return n&&n[1]?n[1].split("-"):[]}var r={};return n.sdk.attrs.prefix,r.keyValueToQs=function(e,n){return(t.isObject(n)||t.isArray(n))&&(n=JSON.stringify(n)),encodeURIComponent(e)+"="+encodeURIComponent(n)},r.objectToQs=function(e){return t.map(e,function(e,t){return r.keyValueToQs(t,e)}).join("&")},r.qsToObject=function(e){var n;return""===e||"?"===e?{}:(e=e.replace(/^\?/,""),n=e.split("&"),t.reduce(n,function(e,t){var n=t.split("=");return e[decodeURIComponent(n[0])]=decodeURIComponent(n[1]),e},{}))},r.dashSeparatedToCamelCase=function(e){return e.replace(/(\-[a-z])/g,function(e){return e.toUpperCase().replace("-","")})},r.camelCaseToDashSeperated=function(e){return e.replace(/([A-Z])/g,function(e){return e.toLowerCase().replace("","-")})},r.dashSeparatedToHuman=function(e){return e.substr(0,1).toUpperCase()+e.substr(1).replace(/(\-[a-z])/g,function(e){return e.toUpperCase().replace("-"," ")})},r.attrsToHtml=function(e){return t.map(e,function(e,t){return r.camelCaseToDashSeperated(t)+'="'+e+'"'},{}).join(" ")},r.loadExternalJs=function(t,n){var i,r=document.getElementsByTagName("head")[0],s=e.defer(),o=!1;return n&&document.getElementById(n)?!1:(i=document.createElement("script"),i.src=t,n&&(i.id=n),i.onload=i.onreadystatechange=function(){o||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(o=!0,s.resolve(),i.onload=i.onreadystatechange=null,r&&i.parentNode&&r.removeChild(i))},r.appendChild(i),s.promise)},r.now=function(e){return+(e||new Date)},r.parseXhrHeaders=function(e){return t.reduce(e.split("\n"),function(e,t){var n=t.indexOf(":");return-1!==n&&(e[r.trim(t.slice(0,n).toLowerCase())]=r.trim(t.slice(n+2))),e},{})},r.trim=function(e){return e.replace(/^\s+|\s+$/g,"")},r.contains=function(e,t,n){return n||(e=e.toLowerCase(),t=t.toLowerCase()),-1!==e.indexOf(t)},r.interpolate=function(e,n){return t.each(n,function(t,n){e=e.replace(new RegExp("{"+n+"}","g"),t)}),e},r.extend=function(e,n,i){return n._super=e,n.prototype=t.extend({},e.prototype,i),n},r.addCommonRequestParams=function(e,n,i){return this.addParamsToQueryString(e,t.extend(this.getCommonRequestParams(i),n||{}))},r.getCommonRequestParams=function(e){return e=e||window,{_:r.now(),gdReferrer:e.document.referrer||"",gdOrigin:this.originWithPath(e),sessionKey:n.sessionKey}},r.buildApiEndpointUrl=function(e,t){var n=r.getClientOrigin(),i=n+e;return r.addCommonRequestParams(i,t)},r.addParamsToQueryString=function(e,t){var n=this.objectToQs(t);return n?e+(-1===e.indexOf("?")?"?":"&")+n:e},r.uuid=function(){var e,t;for(e=t="";e++<36;t+=52&51*e?(15^e?8^Math.random()*(20^e?16:4):4).toString(16):"-");return t},r.isInDebugMode=function(e){return e=e||window,-1!==e.location.host.indexOf(n.sdk.devHost)||-1!==e.location.href.indexOf(n.sdk.devFlag)},r.isInDebugSimulateConsoleMode=function(e){return-1!==e.location.href.indexOf(n.sdk.devSimulateConsoleFlag)},r.allPromisesResolved=function(e){return t.all(e,function(e){return e&&"fulfilled"===e.state})},r.getApiKey=function(){return i()[0]||!1},r.getSdkFrameKey=function(){var e=i();return e[1]||e[0]||!1},r.getFrameOrigin=function(){var e,t,i;return n.api.frameOrigin||(e=r.getSdkOrigin(),t=r.getApiKey(),i=r.getSdkFrameKey(),n.api.frameOrigin=e.replace(t+"-"+i,i)),n.api.frameOrigin},r.getClientOrigin=function(){var e,t,i;return n.api.clientOrigin||(e=r.getSdkOrigin(),t=r.getApiKey(),i=r.getSdkFrameKey(),n.api.clientOrigin=e.replace(t+"-"+i,t)),n.api.clientOrigin},r.getSdkOrigin=function(){var e,n=/(intenthq.com|localhost.gd|1.9.90.net)/,i=/(https?:\/\/[^\/]+)/,r=document.getElementsByTagName("script");if(e=t.find(r,function(e){return n.test(e.src)}),!e)throw new Error("The IHQ SDK domain could not be determined from the <script> tag which loaded the GD SDK.");return e.src.match(i)[1]},r.originWithPath=function(e){return e=e||window,e.location.protocol+"//"+e.location.hostname+(e.location.port?":"+e.location.port:"")+e.location.pathname},r}),n("gd-sdk/logger",["lib/lodash","gd-sdk/config","gd-sdk/utils"],function(e,t,n){var i=function(e){var t,i,r,s=Array.prototype.slice.call(arguments,1),o=window,a=o.document,u="ihqDebugSimulateConsole";if("function"==typeof s[s.length-1]&&s[s.length-1]instanceof o.Window&&(o=s.pop()),n.isInDebugMode(o)){if("undefined"!=typeof o.console&&"undefined"==typeof o.console[e]&&(e="log"),"undefined"!=typeof o.console&&"undefined"!=typeof o.console[e])if("object"==typeof o.console[e])try{Function.prototype.bind.call(o.console[e],o.console).apply(o.console,s)}catch(l){for(r=0;r<s.length;r++)Function.prototype.call.call(o.console[e],o.console,s[r])}else o.console[e].apply(o.console,s);n.isInDebugSimulateConsoleMode(o)&&a&&a.body&&(t=a.getElementById(u),t||(t=a.createElement("div"),t.id=u,a.body.appendChild(t)),i=a.createElement("p"),i.appendChild(a.createTextNode("["+e+"] "+(new Date).toLocaleString()+" => "+s.join(", "))),t.appendChild(i))}};return e.reduce(["debug","error","info","log","warn","dir","dirxml","table","trace","assert","count","markTimeline","profile","profileEnd","time","timeEnd","timeStamp","group","groupCollapsed","groupEnd","clear"],function(t,n){return t[n]=e.partial(i,n),t},{})}),n("gd-sdk/pubsub",["lib/lodash","lib/radio","lib/sha1","gd-sdk/config","gd-sdk/logger"],function(e,t,n,i,r){function s(t,r){e.contains([a,l,u],t)&&((t===a||t===u)&&(i.user.loggedIn=!i.user.loggedIn),i.user.info=r[0],i.user.info.id&&(i.user.info.key=n(i.user.info.id.toString())))}var o="/ihq/all",a="/gd/user/login/success",u="/gd/user/logout",l="/gd/user/edited",c={};return c.publishAlertMessage=function(e,t){c.publish("/gd/message/alert",{message:e,type:t})},c.publishEventToGD=function(e,t){c.publish("/gd/event/outbound",{event:e,params:t||{}})},c.publishEventsFromJson=function(t){var n;try{n="string"==typeof t?JSON.parse(t):t,e.isArray(n)&&e.each(n,function(e){c.publish(e.event,e.params)})}catch(i){r.warn("Could not publish events passed to front-end as JSON: "+t)}},c.publish=function(){var e=Array.prototype.slice.call(arguments),n=e.shift(),i=t(n);s(n,e),i.broadcast.apply(i,e),t(o).broadcast({topic:arguments[0],args:e})},c.subscribe=function(e,n){t(e).subscribe(n)},c.unsubscribe=function(e,n){t(e).unsubscribe(n)},c}),n("gd-sdk/storage",["lib/lodash","lib/sha1","gd-sdk/logger","gd-sdk/pubsub","gd-sdk/config"],function(e,t,n,i,r){var s,o=r.sdk.storage.sdkKey,a=r.sdk.storage.userDataKey,u=!1,l={},c={};return s={LOCAL:"localStorage",SESSION:"sessionStorage",EXPLICITLY_VISITED_PAGES:"explicitlyVisitedPages",RECOMMENDED_PAGES:"recommendedPages",IGNORED_RECOMMENDATIONS:"ignoredRecommendations",init:function(e,t){return u||(u=!0,l[this.LOCAL]=e||window.localStorage,l[this.SESSION]=t||window.sessionStorage,c[this.LOCAL]=this._retrieve(this.LOCAL)||{},c[this.SESSION]=this._retrieve(this.SESSION)||{}),this._currentUserKey=null,this},reset:function(){u=!1,l={},c={}},setItem:function(t,n,i){var r=t.split("."),s=this._getInMemory(i||this.LOCAL),o=!1;return e.each(r,function(t,i){var a=s[t];i===r.length-1?(s[t]=n,o=!0):(s[t]=e.isObject(a)?a:{},s=s[t])}),o&&this._persist(i||this.LOCAL),o},getItem:function(t,n){var i,r=t.split("."),s=this._getInMemory(n||this.LOCAL),o=!0;return e.each(r,function(t,n){var a;o&&(a=s[t],n===r.length-1?i=a:n!==r.length-1&&e.isObject(a)?(s[t]=a,s=s[t]):o=!1)}),i},removeItem:function(t,n){var i=t.split("."),r=this._getInMemory(n||this.LOCAL),s=!1;return e.each(i,function(t,n){var o=r[t];n===i.length-1?(delete r[t],s=!0):(r[t]=e.isObject(o)?o:{},r=r[t])}),s&&this._persist(n||this.LOCAL),s},clear:function(e){c[e]={},this._persist(e)},setSessionKey:function(e){r.sessionKey!==e&&(this.setItem(r.sdk.storage.sessionKey,e,this.LOCAL),i.publish("/gd/session/changed",{sessionKey:e}),r.sessionKey=e)},getSessionKey:function(){return this.getItem(r.sdk.storage.sessionKey)||r.sessionKey},_persist:function(e){var t,i,r="",s=JSON.stringify(this._getInMemory(e));try{l[e].setItem(o,s)}catch(a){0===l[e].length&&(r=" ("+e+" is disabled)"),t=JSON.stringify(l[e]).length,i=s.length,n.warn(e+" quota exceeded: current chars "+t+", current bytes ~ "+2*t+" - required chars "+i+", required bytes "+2*i,r)}},_retrieve:function(e){return JSON.parse(l[e].getItem(o))},_getInMemory:function(e){return u||this.init(),c[e]},_onLogin:function(e){this.setSessionKey(e.session_key)},_onLogout:function(){r.sdk.storage.persistUserDataAcrossSessions||this.removeItem(a+"."+this._currentUserKey,this.LOCAL),this._currentUserKey=r.user.info.key},_onUserDeleted:function(e){this.setSessionKey(e.newSessionKey)},_subscribeToUserEvents:function(){this._boundOnLogin||(this._boundOnLogin=e.bind(this._onLogin,this),this._boundOnLogout=e.bind(this._onLogout,this),this._boundOnUserDeleted=e.bind(this._onUserDeleted,this),i.subscribe("/gd/user/login/success",this._boundOnLogin),i.subscribe("/gd/user/logout",this._boundOnLogout),i.subscribe("/ihq/user/deleted",this._boundOnUserDeleted))}},s._subscribeToUserEvents(),s}),n("gd-sdk/transport/base",["lib/bean","lib/p","lib/lodash","gd-sdk/utils","gd-sdk/config","gd-sdk/logger"],function(e,t,n,i,r,s){var o;return o=function(e){this._windowObject=e||window,this._pending={}},o.extend=n.partial(i.extend,o),o.prototype={send:function(e,i){var r,s;return e=n.extend(this._getDefaultRequestData(),e||{}),this._beforeSend(e),r=JSON.stringify(e),s=t.defer(),this._pending[e.metadata.id]=s,this._send(r,i||{}),s.promise},_getDefaultRequestData:function(){return{metadata:{id:i.uuid(),apiKey:r.apiKey},payload:{}}},start:function(){},_receive:function(t){var i,r;if("object"==typeof t)r=t;else try{r=JSON.parse(t)}catch(o){return s.warn("Recieved non JSON data...could not parse (ignoring): "+t),void 0}this._pending=n.reduce(this._pending,function(e,t,n){return!r||r.responseTo!==n&&r.response_to!==n?e[n]=t:i=t,e},{}),i?i[r.error?"reject":"resolve"](r):r&&e.fire(this,"incoming",r),this._afterReceive(r)},_beforeSend:function(){},_send:function(){},_afterReceive:function(){}},o}),n("gd-sdk/transport/post-message",["lib/bean","lib/lodash","gd-sdk/logger","gd-sdk/utils","gd-sdk/transport/base"],function(e,t,n,i,r){var s=function(e,n){var i=Array.prototype.slice.call(arguments,2);s._super.apply(this,i),this._target=e,this._allowedOrigins=this._processAllowedOrigins(n),this._onMessageBound=t.bind(this._onMessage,this)};return r.extend(s,{start:function(){e.on(window,"message",this._onMessageBound)},_processAllowedOrigins:function(e){var n=[],i=/:[0-9]+$/;return t.each(t.compact(e),function(e){var r=e.match(i);n.push(e),t.isNull(r)||n.push(e.substr(0,e.length-r[0].length))}),n},_send:function(e){var t=1===this._allowedOrigins.length?this._allowedOrigins[0]:"*";n.debug("Sending postMessage:",t,e),this._target.postMessage(e,t)},_onMessage:function(e){return t.contains(this._allowedOrigins,e.origin)?(e.stopImmediatePropagation(),n.debug("Received postMessage:",location.origin,e.origin,e.data),this._receive(e.data),void 0):!1}}),s}),n("gd-sdk/transport/xhr",["lib/bean","lib/p","lib/lodash","gd-sdk/logger","gd-sdk/pubsub","gd-sdk/utils","gd-sdk/config","gd-sdk/transport/base"],function(e,t,n,i,r,s,o,a){var u,l="get",c="text/plain",d=c;return u=function(){u._super.apply(this,arguments)},u.extend=n.partial(s.extend,u),a.extend(u,{_requestType:"XHR",send:function(e){var r=this._createRequestInstance(),a=t.defer();return e=e||{},e.url=this._makeUrlRelative(e.url),e.method=(e.method||l).toLowerCase(),e.headers=n.extend(e.headers||{},{"X-IHQ-API-Key":o.apiKey}),e.data&&(n.contains(["get","delete"],e.method)?n.isObject(e.data)&&(e.url=s.addParamsToQueryString(e.url,e.data),delete e.data):(e.headers=n.extend(e.headers||{},{"Content-Type":e.dataType||d}),"application/json"===e.dataType&&n.isObject(e.data)&&(e.data=JSON.stringify(e.data)))),i.debug("Sending "+this._requestType+" request:",e.method,e.url,e),r.open(e.method,e.url),this._addRequestEvents(r,a,e),e.headers&&n.each(e.headers,function(e,t){r.setRequestHeader(t,e)}),r.send(e.data),a.promise},_createRequestInstance:function(){return new this._windowObject.XMLHttpRequest},_addRequestEvents:function(e,t,i){e.onreadystatechange=n.bind(this._onReadyStateChange,this,e,t,i),e.onerror=n.bind(this._onError,this,t)},_onReadyStateChange:function(e,t,n){var i;return 4!==e.readyState?!1:(i=parseInt(e.status,10),i>=200&&300>i?t.resolve({data:e.responseText,status:i,headers:s.parseXhrHeaders(e.getAllResponseHeaders())}):t.reject(new Error(this._requestType+" call to "+n.url+" failed with status "+i)),void 0)},_onError:function(e,t){e.reject(t||new Error("Unhandled XHR transport failure."))},_makeUrlRelative:function(e){var t=(document.createElement("a"),/(^https?:\/\/[^\/]+)/);return e.replace(t,"").replace(/(^\/?)/,"/")}}),u}),n("gd-sdk/frame/api",["lib/bean","lib/lodash","lib/p","gd-sdk/config","gd-sdk/logger","gd-sdk/storage","gd-sdk/utils","gd-sdk/transport/post-message","gd-sdk/transport/xhr"],function(e,t,n,i,r,s,o,a,u){var l=function(){this._handshake=o.uuid(),this._xhrTransport=new u,this._onIncomingBound=t.bind(this._onIncoming,this),this._sendFrameInitialisedMessageBound=t.bind(this._sendFrameInitialisedMessage,this),r.debug("Instantiating API frame.")};return l.INITIALISED_MESSAGE="apiFrameInitialised",l.prototype={start:function(e){var s=n.defer();return e=e||window,r.debug("Starting API frame."),i.apiKey=this._getApiKey(e),this._xhrTransport.send({url:i.api.sdkBootstrapPath,data:{sessionKey:this._previousSessionKey(),referrer:this._getReferrer(e),gdOrigin:this._getOriginatingUrl(e)}}).then(t.bind(function(n){var r=JSON.parse(n.data)||{},o=n.headers[i.api.sessionKeyHeader];return(e||window)._ihqSendEvents=t.bind(this.sendEventsToParent,this),this._setSessionKey(o),this._startEventPoll(),this._setupPostMessageTransport(r.allowedOrigins),this._sendFrameInitialisedMessage(r),s.resolve(this)},this),function(e){r.error("Error calling bootstrap API",e),s.reject(e)}).done(),s.promise},sendEventsToParent:function(e){var n;try{n=JSON.parse(e)}catch(i){return r.warn("Recieved non JSON data when attempting to send events to the parent of the SDK frame; could not parse, so ignoring: "+e),void 0}t.each(n,t.bind(this._sendResponse,this))},_getFrameDataFromSrc:function(e){return o.qsToObject((e||window).location.hash.substr(1))},_getApiKey:function(e){var t=this._getFrameDataFromSrc(e);return t.apiKey||o.getApiKey()},_getReferrer:function(e){var t=this._getFrameDataFromSrc(e);return t.gdReferrer},_getOriginatingUrl:function(e){var t=this._getFrameDataFromSrc(e);return t.gdOrigin},_previousSessionKey:function(e){var t=this._getFrameDataFromSrc(e);return t.overrideSessionKey||s.getSessionKey()||t.sessionKey},_setSessionKey:function(e){if(!e)throw new Error("Tried to set falsy sessionKey in the API frame, refusing to do so to prevent wiping out the sessionKey already stored.");s.setSessionKey(e)},_setupPostMessageTransport:function(t){this._postMessageTransport=new a(window.parent,t),e.on(this._postMessageTransport,"incoming",this._onIncomingBound),this._postMessageTransport.start()},_sendFrameInitialisedMessage:function(e){return this._sendResponse(t.extend({},e,{handshake:this._handshake,type:l.INITIALISED_MESSAGE,sessionKey:i.sessionKey}))},_onIncoming:function(e){var n;return e&&e.handshake===this._handshake?(delete e.handshake,(n=this._xhrTransport.send(e))?(n.then(t.bind(function(t){t.headers&&t.headers[i.api.sessionKeyHeader]&&s.setSessionKey(t.headers[i.api.sessionKeyHeader]),this._sendResponse(t,e.metadata.id)},this),t.bind(function(){this._sendResponse({error:!0},e.metadata.id)},this)).done(),void 0):!1):!1},_sendResponse:function(e,t){t&&(e.responseTo=t),this._postMessageTransport.send(e)},_startEventPoll:function(e){e=e||window,e.navigator.userAgent.match("CriOS")&&e.setInterval(t.bind(this._checkForPendingEvents,this),250)},_checkForPendingEvents:function(e){var t;e=e||window,t=e.localStorage.getItem("pluginEvents"),t&&(e.localStorage.removeItem("pluginEvents"),e._ihqSendEvents(t))}},l}),n("gd-sdk/proxy/api",["lib/bean","lib/p","lib/lodash","lib/sha1","gd-sdk/config","gd-sdk/logger","gd-sdk/pubsub","gd-sdk/utils","gd-sdk/storage","gd-sdk/transport/post-message","gd-sdk/frame/api"],function(e,t,n,i,r,s,o,a,u,l,c){var d,h=t.defer(),g=!0,p={},f=12e4;return p._type="api",p.load=function(t,i){var o,c,p,m=u.getSessionKey();return i=i||window,p=n.extend(a.getCommonRequestParams(i),{apiKey:r.apiKey}),g?(s.debug("Loading API frame proxy"),g=!1,o=a.getFrameOrigin(),delete p._,delete p.sessionKey,m&&(p.sessionKey=m),t&&(p.overrideSessionKey=t),c=i.document.createElement("iframe"),c.sandbox=r.sdk.attrs.sandbox,c.src=o+r.api.sdkFramePath+"#"+a.objectToQs(p),c.style.display="none",i.document.body.appendChild(c),this._onIncomingBound=n.bind(this._onIncoming,this),d=new l(c.contentWindow,[o]),e.on(d,"incoming",this._onIncomingBound),d.start(),h.promise.timeout(f)):!1
},p.requestViaFrame=function(e){var i=t.defer();return h.promise.then(n.bind(function(){n.extend(e,{handshake:(r.handshakes||{})[this._type]}),e.url&&(e.url=a.addCommonRequestParams(e.url)),d.send(e).then(function(e){e.headers&&e.headers[r.api.sessionKeyHeader]&&u.setSessionKey(e.headers[r.api.sessionKeyHeader]),i.resolve(e)},function(e){s.warn("apiProxy post message failed",e),i.reject(e)}).done()},this),function(e){s.warn("apiProxy.requestViaFrame failed",e),i.reject(e)}).done(),i.promise},p._onIncoming=function(e){return e?(e.type===c.INITIALISED_MESSAGE?(s.debug("API frame initialised message received"),s.debug("Setting session key"),u.setSessionKey(e.sessionKey),r.handshakes=r.handshakes||{},r.handshakes[this._type]=e.handshake,delete e.handshake,r.user.loggedIn=e.loggedIn,r.user.info=e.user,e.user&&e.user.id&&(r.user.info.key=i(e.user.id.toString())),s.debug("Resolving API frame"),h.resolve(e)):e.event?o.publish(e.event,e.params):e.event_name&&o.publish(e.event_name,e.params),void 0):!1},p._frameDfd=function(e){return"undefined"==typeof e?h:(h=e,void 0)},p._canLoad=function(e){return"undefined"==typeof e?g:(g=e,void 0)},p._postMessageTransport=function(e){return"undefined"==typeof e?d:(d=e,void 0)},p}),n("gd-sdk/request",["lib/p","lib/lodash","gd-sdk/config","gd-sdk/proxy/api","gd-sdk/frame/api","gd-sdk/logger"],function(e,t,n,i){var r=e.defer(),s={};return s.setup=function(e){return i.load(e).then(r.resolve,r.reject).done(),r.promise},s.send=function(t){var n=e.defer();return r.promise.then(function(){i.requestViaFrame(t).then(n.resolve,n.reject)},function(){n.reject(new Error("The request frame never finished initialising."))}).done(),n.promise},s._proxyPromise=function(e){return"undefined"==typeof e?r.promise:(r.promise=e,void 0)},s._proxyDfd=function(e){return"undefined"==typeof e?r:(r=e,void 0)},s}),n("gd-sdk/api",["lib/lodash","lib/p","gd-sdk/request"],function(e,t,n){return{request:function(i){var r=t.defer(),s=e.pick(i||{},"url","method","dataType","data");return e.contains(["post","put"],s.method)&&!s.dataType&&(s.dataType="application/json"),n.send(s).then(function(e){var t;try{t=JSON.parse(e.data)}catch(n){t=e.data}r.resolve(t)},function(e){r.reject(e)}).done(),r.promise},get:function(t){return this.request(e.extend(t||{},{method:"get"}))},post:function(t){return this.request(e.extend(t||{},{method:"post"}))},put:function(t){return this.request(e.extend(t||{},{method:"put"}))},del:function(t){return this.request(e.extend(t||{},{method:"delete"}))}}}),!function(e,t){"undefined"!=typeof module?module.exports=t():"function"==typeof n&&"object"==typeof n.amd?n("lib/domready",t):this[e]=t()}("domready",function(e){function t(e){for(g=1;e=i.shift();)e()}var n,i=[],r=!1,s=document,o=s.documentElement,a=o.doScroll,u="DOMContentLoaded",l="addEventListener",c="onreadystatechange",d="readyState",h=a?/^loaded|^c/:/^loaded|c/,g=h.test(s[d]);return s[l]&&s[l](u,n=function(){s.removeEventListener(u,n,r),t()},r),a&&s.attachEvent(c,n=function(){/^c/.test(s[d])&&(s.detachEvent(c,n),t())}),e=a?function(t){self!=top?g?t():i.push(t):function(){try{o.doScroll("left")}catch(n){return setTimeout(function(){e(t)},50)}t()}()}:function(e){g?e():i.push(e)}}),n("gd-sdk/dom-ready",["lib/domready","lib/p","gd-sdk/utils"],function(e,t,n){var i={},r=3e4,s=100;return i.wait=function(){var o,a=t.defer(),u=n.now();return e(function(){o=n.now(),setTimeout(function(){a.resolve()},i._isSafari()?Math.max(0,s-(o-u)):0)}),a.promise.timeout(r)},i._isSafari=function(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("safari")&&-1===e.indexOf("chrome")},i}),n("gd-sdk/sanitise",["lib/lodash"],function(e){function t(e){var t;if(!~e.indexOf("&"))return e;for(t in h)h.hasOwnProperty(t)&&(e=e.replace(new RegExp(t,"g"),h[t]));return e=e.replace(/&#x(0*[0-9a-f]{2,5});?/gi,function(e,t){return String.fromCharCode(parseInt(+t,16))}),e=e.replace(/&#([0-9]{2,4});?/gi,function(e,t){return String.fromCharCode(+t)}),e=e.replace(/&amp;/g,"&")}function n(e){var t;e=e.replace(/&/g,"&amp;"),e=e.replace(/'/g,"&#39;");for(t in h)h.hasOwnProperty(t)&&(e=e.replace(new RegExp(h[t],"g"),t));return e}function i(n,i,a){var h,f,_,b,v,y,k,w,N=[],E="alert|applet|audio|basefont|base|behavior|bgsound|blink|body|embed|expression|form|frameset|frame|head|html|ilayer|iframe|input|isindex|layer|link|meta|object|plaintext|style|script|textarea|title|video|xml|xss".split("|"),S=["\\bon\\w*","\\bstyle","\\bformaction"],x=function(e,t,n,i,r,s,o,a,u){return++w,t+n+" "+r+o+a+u};if("string"!=typeof n)throw new TypeError("sanitise#xss - value to be sanitised must be a string: "+n);n=r(n);do h=s();while(n.indexOf(h)>=0);n=n.replace(/\&([a-z\_0-9\-]+)\=([a-z\_0-9\-]+)/gi,h+"$1=$2"),n=n.replace(/(&#?[0-9a-z]{2,})([\x00-\x20])*;?/gi,"$1;$2"),n=n.replace(/(&#x?)([0-9A-F]+);?/gi,"$1$2;"),n=n.replace(new RegExp(h,"g"),"&");try{n=decodeURIComponent(n)}catch(C){}n=n.replace(/[a-z]+=([\'\"]).*?\1/gi,function(e,t){return e.replace(t,o(t))}),n=n.replace(/<\w+.*/gi,function(e){return e.replace(e,t(e))}),n=r(n),n=n.replace("	"," "),f=n;for(_ in g)g.hasOwnProperty(_)&&(n=n.replace(new RegExp(_,"gi"),g[_]));for(_ in p)p.hasOwnProperty(_)&&(n=n.replace(new RegExp(_,"gi"),p[_]));for(_=0,b=m.length;b>_;_++)v=m[_].split("").join("\\s*")+"\\s*",n=n.replace(new RegExp("("+v+")(\\W)","ig"),l);do y=n,n.match(/<a/i)&&(n=n.replace(/<a\s+([^>]*?)(>|$)/gi,c)),n.match(/<img/i)&&(n=n.replace(/<img\s+([^>]*?)(\s?\/?>|$)/gi,d)),(n.match(/script/i)||n.match(/xss/i))&&(n=n.replace(/<(\/*)(script|xss)(.*?)\>/gi,"[removed]"));while(y!==n);a||S.push("xmlns");do if(k=[],w=0,k=k.concat(n.match(new RegExp("("+S.join("|")+")\\s*=\\s*(\\x22|\\x27)([^\\2]*?)(\\2)","ig"))),k=k.concat(n.match(new RegExp("("+S.join("|")+")\\s*=\\s*([^\\s>]*)","ig"))),k=e.filter(k,u),k.length>0){for(_=0;_<k.length;++_)k[_]=k[_].replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g"),"\\$&");n=n.replace(new RegExp("(<?)(/?[^><]+?)([^A-Za-z<>\\-])(.*?)("+k.join("|")+")(.*?)([\\s><]?)([><]*)","i"),x)}while(w>0);for(N=[],_=0;_<E.length;_++)-1===e.indexOf(i||[],E[_])&&N.push(E[_]);n=n.replace(new RegExp("<(/*\\s*)("+N.join("|")+")([^><]*)([><]*)","gi"),function(e,t,n,i,r){return"&lt;"+t+n+i+r.replace(">","&gt;").replace("<","&lt;")}),n=n.replace(/(alert|eval|new\sFunction)(\s*)\((.*?)\)/gi,"$1$2&#40;$3&#41;");for(_ in g)p.hasOwnProperty(_)&&(n=n.replace(new RegExp(_,"gi"),g[_]));for(_ in p)p.hasOwnProperty(_)&&(n=n.replace(new RegExp(_,"gi"),p[_]));if(a&&n!==f)throw new Error("Image may contain XSS");return n}function r(e){var t,n;for(t=0,n=f.length;n>t;t++)e=e.replace(f[t],"");return e}function s(){for(var e="",t=10;t--;)e+=String.fromCharCode(97|25*Math.random());return e}function o(e){return e.replace(">","&gt;").replace("<","&lt;").replace("\\","\\\\")}function a(e){var t="",n=0,i=e.match(/(?:\s*[a-z-]+\s*=\s*(\x22|\x27)([^\1]*?)\1|\s*data-[a-z-]+\s*[^a-z-=])/gi);if(i)for(n=0;n<i.length;++n)t+=i[n].replace(/\*.*?\*/g,"");return t}function u(e){return null!==e}function l(e,t,n){return t.replace(/\s+/g,"")+n}function c(e,t){var n=a(t.replace("<","").replace(">",""));return n=n.replace(/\s+(href="(?:.*)?(?:alert\(|alert&#40;|javascript:|livescript:|mocha:|charset=|window\.|document\.|\.cookie|<script|<xss|data\s*:)(?:[^"]*))/gi," "),n=n.replace(/\s+(href='(?:.*)?(?:alert\(|alert&#40;|javascript:|livescript:|mocha:|charset=|window\.|document\.|\.cookie|<script|<xss|data\s*:)(?:[^']*))/gi," "),n=n.replace(/\s+(href=`(?:.*)?(?:alert\(|alert&#40;|javascript:|livescript:|mocha:|charset=|window\.|document\.|\.cookie|<script|<xss|data\s*:)(?:[^`]*))/gi," "),n=n.replace(/\s+(href=[^"|'](?:.*)?(?:alert\(|alert&#40;|javascript:|livescript:|mocha:|charset=|window\.|document\.|\.cookie|<script|<xss|data\s*:)(?:[^\s]*))/gi," "),e.replace(t,n)}function d(e,t){var n=a(t.replace("<","").replace(">",""));return n=n.replace(/\s+(src="(?:.*)?(?:alert\(|alert&#40;|javascript:|livescript:|mocha:|charset=|window\.|document\.|\.cookie|<script|<xss|base64\s*,)(?:[^"]*))/gi," "),n=n.replace(/\s+(src='(?:.*)?(?:alert\(|alert&#40;|javascript:|livescript:|mocha:|charset=|window\.|document\.|\.cookie|<script|<xss|base64\s*,)(?:[^']*))/gi," "),n=n.replace(/\s+(src=`(?:.*)?(?:alert\(|alert&#40;|javascript:|livescript:|mocha:|charset=|window\.|document\.|\.cookie|<script|<xss|base64\s*,)(?:[^`]*))/gi," "),n=n.replace(/\s+(src=[^"|'](?:.*)?(?:alert\(|alert&#40;|javascript:|livescript:|mocha:|charset=|window\.|document\.|\.cookie|<script|<xss|base64\s*,)(?:[^\s]*))/gi," "),e.replace(t,n)}var h={"&nbsp;":" ","&iexcl;":"¡","&cent;":"¢","&pound;":"£","&euro;":"€","&yen;":"¥","&brvbar;":"Š","&sect;":"§","&uml;":"š","&copy;":"©","&ordf;":"ª","&laquo;":"«","&not;":"¬","&shy;":"­","&reg;":"®","&macr;":"¯","&deg;":"°","&plusmn;":"±","&sup2;":"²","&sup3;":"³","&acute;":"Ž","&micro;":"µ","&para;":"¶","&middot;":"·","&cedil;":"ž","&sup1;":"¹","&ordm;":"º","&raquo;":"»","&frac14;":"Œ","&frac12;":"½","&frac34;":"Ÿ","&iquest;":"¿","&Agrave;":"À","&Aacute;":"Á","&Acirc;":"Â","&Atilde;":"Ã","&Auml;":"Ä","&Aring;":"Å","&AElig;":"Æ","&Ccedil;":"Ç","&Egrave;":"È","&Eacute;":"É","&Ecirc;":"Ê","&Euml;":"Ë","&Igrave;":"Ì","&Iacute;":"Í","&Icirc;":"Î","&Iuml;":"Ï","&ETH;":"Ð","&Ntilde;":"Ñ","&Ograve;":"Ò","&Oacute;":"Ó","&Ocirc;":"Ô","&Otilde;":"Õ","&Ouml;":"Ö","&times;":"×","&Oslash;":"Ø","&Ugrave;":"Ù","&Uacute;":"Ú","&Ucirc;":"Û","&Uuml;":"Ü","&Yacute;":"Ý","&THORN;":"Þ","&szlig;":"ß","&agrave;":"à","&aacute;":"á","&acirc;":"â","&atilde;":"ã","&auml;":"ä","&aring;":"å","&aelig;":"æ","&ccedil;":"ç","&egrave;":"è","&eacute;":"é","&ecirc;":"ê","&euml;":"ë","&igrave;":"ì","&iacute;":"í","&icirc;":"î","&iuml;":"ï","&eth;":"ð","&ntilde;":"ñ","&ograve;":"ò","&oacute;":"ó","&ocirc;":"ô","&otilde;":"õ","&ouml;":"ö","&divide;":"÷","&oslash;":"ø","&ugrave;":"ù","&uacute;":"ú","&ucirc;":"û","&uuml;":"ü","&yacute;":"ý","&thorn;":"þ","&yuml;":"ÿ","&quot;":'"',"&lt;":"<","&gt;":">","&apos;":"'","&minus;":"−","&circ;":"ˆ","&tilde;":"˜","&Scaron;":"Š","&lsaquo;":"‹","&OElig;":"Œ","&lsquo;":"‘","&rsquo;":"’","&ldquo;":"“","&rdquo;":"”","&bull;":"•","&ndash;":"–","&mdash;":"—","&trade;":"™","&scaron;":"š","&rsaquo;":"›","&oelig;":"œ","&Yuml;":"Ÿ","&fnof;":"ƒ","&Alpha;":"Α","&Beta;":"Β","&Gamma;":"Γ","&Delta;":"Δ","&Epsilon;":"Ε","&Zeta;":"Ζ","&Eta;":"Η","&Theta;":"Θ","&Iota;":"Ι","&Kappa;":"Κ","&Lambda;":"Λ","&Mu;":"Μ","&Nu;":"Ν","&Xi;":"Ξ","&Omicron;":"Ο","&Pi;":"Π","&Rho;":"Ρ","&Sigma;":"Σ","&Tau;":"Τ","&Upsilon;":"Υ","&Phi;":"Φ","&Chi;":"Χ","&Psi;":"Ψ","&Omega;":"Ω","&alpha;":"α","&beta;":"β","&gamma;":"γ","&delta;":"δ","&epsilon;":"ε","&zeta;":"ζ","&eta;":"η","&theta;":"θ","&iota;":"ι","&kappa;":"κ","&lambda;":"λ","&mu;":"μ","&nu;":"ν","&xi;":"ξ","&omicron;":"ο","&pi;":"π","&rho;":"ρ","&sigmaf;":"ς","&sigma;":"σ","&tau;":"τ","&upsilon;":"υ","&phi;":"φ","&chi;":"χ","&psi;":"ψ","&omega;":"ω","&thetasym;":"ϑ","&upsih;":"ϒ","&piv;":"ϖ","&ensp;":" ","&emsp;":" ","&thinsp;":" ","&zwnj;":"‌","&zwj;":"‍","&lrm;":"‎","&rlm;":"‏","&sbquo;":"‚","&bdquo;":"„","&dagger;":"†","&Dagger;":"‡","&hellip;":"…","&permil;":"‰","&prime;":"′","&Prime;":"″","&oline;":"‾","&frasl;":"⁄","&image;":"ℑ","&weierp;":"℘","&real;":"ℜ","&alefsym;":"ℵ","&larr;":"←","&uarr;":"↑","&rarr;":"→","&darr;":"↓","&harr;":"↔","&crarr;":"↵","&lArr;":"⇐","&uArr;":"⇑","&rArr;":"⇒","&dArr;":"⇓","&hArr;":"⇔","&forall;":"∀","&part;":"∂","&exist;":"∃","&empty;":"∅","&nabla;":"∇","&isin;":"∈","&notin;":"∉","&ni;":"∋","&prod;":"∏","&sum;":"∑","&lowast;":"∗","&radic;":"√","&prop;":"∝","&infin;":"∞","&ang;":"∠","&and;":"∧","&or;":"∨","&cap;":"∩","&cup;":"∪","&int;":"∫","&there4;":"∴","&sim;":"∼","&cong;":"≅","&asymp;":"≈","&ne;":"≠","&equiv;":"≡","&le;":"≤","&ge;":"≥","&sub;":"⊂","&sup;":"⊃","&nsub;":"⊄","&sube;":"⊆","&supe;":"⊇","&oplus;":"⊕","&otimes;":"⊗","&perp;":"⊥","&sdot;":"⋅","&lceil;":"⌈","&rceil;":"⌉","&lfloor;":"⌊","&rfloor;":"⌋","&lang;":"〈","&rang;":"〉","&loz;":"◊","&spades;":"♠","&clubs;":"♣","&hearts;":"♥","&diams;":"♦"},g={"document.cookie":"[removed]","document.write":"[removed]",".parentNode":"[removed]",".innerHTML":"[removed]","window.location":"[removed]","-moz-binding":"[removed]","<!--":"&lt;!--","-->":"--&gt;","(<!\\[CDATA\\[)":"&lt;![CDATA[","<comment>":"&lt;comment&gt;"},p={"javascript\\s*:":"[removed]","expression\\s*(\\(|&#40;)":"[removed]","vbscript\\s*:":"[removed]","Redirect\\s+302":"[removed]","([\"'])?data\\s*:[^\\1]*?base64[^\\1]*?,[^\\1]*?\\1?":"[removed]"},f=[/%0[0-8bcef]/g,/%1[0-9a-f]/g,/[\x00-\x08]/g,/\x0b/g,/\x0c/g,/[\x0e-\x1f]/g],m=["javascript","expression","vbscript","script","base64","applet","alert","document","write","cookie","window"];return{encode:n,decode:t,xss:i}}),!function(e,t){"function"==typeof n?n("lib/morpheus",t):"undefined"!=typeof module?module.exports=t():this[e]=t()}("morpheus",function(){function e(e,t,n){if(Array.prototype.indexOf)return e.indexOf(t);for(n=0;n<e.length;++n)if(e[n]===t)return n}function t(e){var n,i=L.length;for(v&&e>1e12&&(e=y()),n=i;n--;)L[n](e);L.length&&D(t)}function n(e){1===L.push(e)&&D(t)}function i(t){var n,i=e(L,t);i>=0&&(n=L.slice(i+1),L.length=i,L=L.concat(n))}function r(e,t){var n,i={};return(n=e.match(x))&&(i.rotate=p(n[1],t?t.rotate:null)),(n=e.match(C))&&(i.scale=p(n[1],t?t.scale:null)),(n=e.match(A))&&(i.skewx=p(n[1],t?t.skewx:null),i.skewy=p(n[3],t?t.skewy:null)),(n=e.match(I))&&(i.translatex=p(n[1],t?t.translatex:null),i.translatey=p(n[3],t?t.translatey:null)),i}function s(e){var t="";return"rotate"in e&&(t+="rotate("+e.rotate+"deg) "),"scale"in e&&(t+="scale("+e.scale+") "),"translatex"in e&&(t+="translate("+e.translatex+"px,"+e.translatey+"px) "),"skewx"in e&&(t+="skew("+e.skewx+"deg,"+e.skewy+"deg)"),t}function o(e,t,n){return"#"+(1<<24|e<<16|t<<8|n).toString(16).slice(1)}function a(e){var t=/rgba?\((\d+),\s*(\d+),\s*(\d+)/.exec(e);return(t?o(t[1],t[2],t[3]):e).replace(/#(\w)(\w)(\w)$/,"#$1$1$2$2$3$3")}function u(e){return e.replace(/-(.)/g,function(e,t){return t.toUpperCase()})}function l(e){return"function"==typeof e}function c(e,t,r,s,o,a){function u(e){var n=e-g;return n>c||p?(a=isFinite(a)?a:1,p?m&&t(a):t(a),i(u),r&&r.apply(d)):(isFinite(a)?t(h*s(n/c)+o):t(s(n/c)),void 0)}s=l(s)?s:f.easings[s]||function(e){return Math.sin(e*Math.PI/2)};var c=e||w,d=this,h=a-o,g=y(),p=0,m=0;return n(u),{stop:function(e){p=1,m=e,e||(r=null)}}}function d(e,t){var n,i,r=e.length,s=[];for(n=0;r>n;++n)s[n]=[e[n][0],e[n][1]];for(i=1;r>i;++i)for(n=0;r-i>n;++n)s[n][0]=(1-t)*s[n][0]+t*s[parseInt(n+1,10)][0],s[n][1]=(1-t)*s[n][1]+t*s[parseInt(n+1,10)][1];return[s[0][0],s[0][1]]}function h(e,t,n){var i,r,s,o,a=[];for(i=0;6>i;i++)s=Math.min(15,parseInt(t.charAt(i),16)),o=Math.min(15,parseInt(n.charAt(i),16)),r=Math.floor((o-s)*e+s),r=r>15?15:0>r?0:r,a[i]=r.toString(16);return"#"+a.join("")}function g(e,t,n,i,r,s,o){if("transform"==r){o={};for(var a in n[s][r])o[a]=a in i[s][r]?Math.round(((i[s][r][a]-n[s][r][a])*e+n[s][r][a])*w)/w:n[s][r][a];return o}return"string"==typeof n[s][r]?h(e,n[s][r],i[s][r]):(o=Math.round(((i[s][r]-n[s][r])*e+n[s][r])*w)/w,r in T||(o+=t[s][r]||"px"),o)}function p(e,t,n,i,r){return(n=E.exec(e))?(r=parseFloat(n[2]))&&t+("+"==n[1]?1:-1)*r:parseFloat(e)}function f(e,t){var n,i,o,h=e?h=isFinite(e.length)?e:[e]:[],f=t.complete,m=t.duration,_=t.easing,b=t.bezier,v=[],y=[],k=[],w=[];for(delete t.complete,delete t.duration,delete t.easing,delete t.bezier,b&&(i=t.left,o=t.top,delete t.right,delete t.bottom,delete t.left,delete t.top),n=h.length;n--;){if(v[n]={},y[n]={},k[n]={},b){var E=M(h[n],"left"),x=M(h[n],"top"),C=[p(l(i)?i(h[n]):i||0,parseFloat(E)),p(l(o)?o(h[n]):o||0,parseFloat(x))];w[n]=l(b)?b(h[n],C):b,w[n].push(C),w[n].unshift([parseInt(E,10),parseInt(x,10)])}for(var A in t){var I,T=M(h[n],A),D=l(t[A])?t[A](h[n]):t[A];"string"!=typeof D||!N.test(D)||N.test(T)?(v[n][A]="transform"==A?r(T):"string"==typeof D&&N.test(D)?a(T).slice(1):parseFloat(T),y[n][A]="transform"==A?r(D,v[n][A]):"string"==typeof D&&"#"==D.charAt(0)?a(D).slice(1):p(D,parseFloat(T)),"string"==typeof D&&(I=D.match(S))&&(k[n][A]=I[1])):delete t[A]}}return c.apply(h,[m,function(e,i,r){for(n=h.length;n--;){b&&(r=d(w[n],e),h[n].style.left=r[0]+"px",h[n].style.top=r[1]+"px");for(var o in t)i=g(e,k,v,y,o,n),"transform"==o?h[n].style[P]=s(i):"opacity"!=o||O?h[n].style[u(o)]=i:h[n].style.filter="alpha(opacity="+100*i+")"}},f,_])}var m=document,_=window,b=_.performance,v=b&&(b.now||b.webkitNow||b.msNow||b.mozNow),y=v?function(){return v.call(b)}:function(){return+new Date},k=m.documentElement,w=1e3,N=/^rgb\(|#/,E=/^([+\-])=([\d\.]+)/,S=/^(?:[\+\-]=)?\d+(?:\.\d+)?(%|in|cm|mm|em|ex|pt|pc|px)$/,x=/rotate\(((?:[+\-]=)?([\-\d\.]+))deg\)/,C=/scale\(((?:[+\-]=)?([\d\.]+))\)/,A=/skew\(((?:[+\-]=)?([\-\d\.]+))deg, ?((?:[+\-]=)?([\-\d\.]+))deg\)/,I=/translate\(((?:[+\-]=)?([\-\d\.]+))px, ?((?:[+\-]=)?([\-\d\.]+))px\)/,T={lineHeight:1,zoom:1,zIndex:1,opacity:1,transform:1},P=function(){var e,t=m.createElement("a").style,n=["webkitTransform","MozTransform","OTransform","msTransform","Transform"];for(e=0;e<n.length;e++)if(n[e]in t)return n[e]}(),O=function(){return"undefined"!=typeof m.createElement("a").style.opacity}(),M=m.defaultView&&m.defaultView.getComputedStyle?function(e,t){t="transform"==t?P:t;var n=null,i=m.defaultView.getComputedStyle(e,"");return i&&(n=i[u(t)]),e.style[t]||n}:k.currentStyle?function(e,t){if(t=u(t),"opacity"==t){var n=100;try{n=e.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(i){try{n=e.filters("alpha").opacity}catch(r){}}return n/100}var s=e.currentStyle?e.currentStyle[t]:null;return e.style[t]||s}:function(e,t){return e.style[u(t)]},D=function(){return _.requestAnimationFrame||_.webkitRequestAnimationFrame||_.mozRequestAnimationFrame||_.msRequestAnimationFrame||_.oRequestAnimationFrame||function(e){_.setTimeout(function(){e(+new Date)},17)}}(),L=[];return f.tween=c,f.getStyle=M,f.bezier=d,f.transform=P,f.parseTransform=r,f.formatTransform=s,f.easings={},f}),n("gd-sdk/animation",["lib/morpheus","lib/p","lib/lodash"],function(e,t,n){return{run:function(i,r){var s=t.defer();return e(i,n.extend({complete:function(){s.resolve()}},r)),s.promise}}}),n("gd-sdk/metrics/environment",["lib/lodash"],function(e){function t(t,n){var i,r={};if("undefined"!=typeof t)for(i in t)e.contains(["string","number","boolean"],typeof t[i])&&(!e.isArray(n)&&t.hasOwnProperty(i)||e.isArray(n)&&e.contains(n,i))&&(!e.isArray(t)||e.isArray(t)&&"length"!==i&&"number"!=typeof i)&&(r[i]=t[i]);return r}return{SCREEN_WHITELIST:["availHeight","availLeft","availTop","availWidth","colorDepth","height","pixelDepth","width"],NAVIGATOR_WHITELIST:["appCodeName","appName","appVersion","cookieEnabled","language","onLine","platform","product","productSub","userAgent","vendor","vendorSub"],MIMETYPE_WHITELIST:["description","suffixes","type"],PLUGIN_WHITELIST:["description","filename","name"],getBrowserInfo:function(){var n=window.navigator,i=t(n,this.NAVIGATOR_WHITELIST);return n.plugins&&(i.plugins=[],e.each(n.plugins,function(e){i.plugins.push(t(e,this.PLUGIN_WHITELIST))},this)),n.mimeTypes&&(i.mimeTypes=[],e.each(n.mimeTypes,function(e){i.mimeTypes.push(t(e,this.MIMETYPE_WHITELIST))},this)),i},getScreenInfo:function(){return t(window.screen,this.SCREEN_WHITELIST)},getPageSize:function(){var e=document.body,t=document.documentElement,n=this.getViewportSize();return{height:Math.max(t.clientHeight,t.offsetHeight,t.scrollHeight,e.offsetHeight,e.scrollHeight,n.height),width:Math.max(t.clientWidth,t.offsetWidth,t.scrollWidth,e.offsetWidth,e.scrollWidth,n.width)}},getScroll:function(){var e=void 0!==window.pageYOffset,t=this.getPageSize(),n=this.getViewportSize(),i=document.body,r=document.documentElement||i.parentNode||i,s={x:e?window.pageXOffset:r.scrollLeft,y:e?window.pageYOffset:r.scrollTop};return s.x<0&&(s.x=0),s.x+n.width>t.width&&(s.x=t.width-n.width),s.y<0&&(s.y=0),s.y+n.height>t.height&&(s.y=t.height-n.height),s},getViewportSize:function(){var e=document.body;return{height:window.innerHeight||e.clientHeight||0,width:window.innerWidth||e.clientWidth||0}}}}),n("gd-sdk/plugin/utils",["lib/lodash","lib/p","gd-sdk/sanitise","gd-sdk/config","gd-sdk/dom-ready","gd-sdk/logger","gd-sdk/utils"],function(e,t,n,i,r,s){var o=i.sdk.attrs.prefix,a={};return a.register=function(t,n,r,o){var a={construct:n};s.debug("Registering plugin:",t),r&&(a.src=r),i.pluginList.plugins[t]=a,o&&e.each(o,function(e){i.pluginList.groups[e]?i.pluginList.groups[e].push(t):i.pluginList.groups[e]=[t]})},a.startAll=function(){var e=a._findNodes();return a.startSome(e)},a.startSome=function(t){return e.reduce(t,function(e,t){var n=t.getAttribute(o+"plugin");return i.pluginList.plugins[n]?e.push(a.startPlugin(t,n)):i.pluginList.groups[n]&&(e=e.concat(a.startGroup(t,n))),e},[])},a.startPlugin=function(n,r){var a,u=t.defer(),l=i.pluginList.plugins[r],c=e.contains(i.features.pluginsBlackList.split(","),r);return!l||n.hasAttribute(o+"started")||c?(s.error("Plugin does not exist, or is already started:",r),!1):(a=new l.construct(r,n,l.src),n.setAttribute(o+"started",!0),a.load().then(function(){u.resolve(a)},function(){u.reject(a)}).done(),u.promise)},a.startWithin=function(e){return a.startSome(a._findNodes(e))},a.startGroup=function(t,n){var r=i.pluginList.groups[n];return r?e.map(r,function(e){var n=a._createGroupMemberNode(t,e);return a.startPlugin(n,e)}):!1},a.createPluginNode=function(t,i,r){var s=document.createElement("div");return r=r||window,e.each(i||{},function(t,i){t="object"==typeof t?r.encodeURIComponent(r.encodeURIComponent(JSON.stringify(t))):t,e.isUndefined(t)||e.isNull(t)||(t=n.xss(t.toString())),s.setAttribute(n.xss(o+i),t)}),s.setAttribute(o+"plugin",n.xss(t)),s},a.getAncestors=function(e){for(var t=[],n=e;n;)t.push(n),n=n.parentNode;return t},a.isNodeHiddenByCSS=function(e){var t,n,i,r=this.getAncestors(e),s=r.length;for(t=0;s>t;t++)if(n=r[t].style,i=!!n&&("none"===n.display||"hidden"===n.visibility||parseFloat(n.opacity,10)<1))return!0;return!1},a._createGroupMemberNode=function(e,t){var i,r,s,u={};for(s=0;s<e.attributes.length;s++)r=e.attributes[s],0===r.name.indexOf(o)&&(u[n.xss(r.name.substr(o.length))]=n.xss(r.value));return i=a.createPluginNode(n.xss(t),u),e.appendChild(i),i},a._findNodes=function(e){return(e||document).querySelectorAll("["+o+"plugin]")},a}),n("gd-sdk/plugin/base",["lib/lodash","lib/p","gd-sdk/config","gd-sdk/pubsub","gd-sdk/request","gd-sdk/sanitise","gd-sdk/utils","gd-sdk/logger","gd-sdk/metrics/environment","gd-sdk/plugin/utils"],function(e,t,n,i,r,s,o,a,u,l){var c,d=n.sdk.attrs.prefix,h=n.sdk.attrs.ignored,g=d+"plugin-loading",p=1e3;return c=function(t,n,i,r){this._loaded=!1,this._subscribedToTopics=!1,this._shouldMonitorVisibility=!0,this._pluginSeenCount=0,this._type=t,this._node=n,this._src=i,this._windowObject=r||window,this._loadMethod="get",this._loadData=null,this._loadDataType=null,this._internalWaitDfd=null,this._topics={},this._boundCheckVisibility=e.bind(this._checkVisibility,this)},c.extend=e.partial(o.extend,c),c.register=l.register,c.prototype={load:function(){var e=t.defer();return this._loaded?!1:(this._onLoadStart(),this._loaded=!0,t.allSettled([this._loadContents(),this._internalWaitDfd&&this._internalWaitDfd.promise]).then(function(t){o.allPromisesResolved(t)?e.resolve(t[0].value):e.reject()}).done(),e.promise)},reload:function(){return this._destroy(),this._loaded=!1,this.load()},unload:function(){this._destroy(),this._unsubscribeFromTopics(),this._loaded=!1,this._node.parentNode.removeChild(this._node)},isStarted:function(){return!!this._node.getAttribute(d+"started")},isEmpty:function(){return 0===this._node.childNodes.length},isHidden:function(){return l.isNodeHiddenByCSS(this._node,this._windowObject)},isInViewport:function(){var e=this._node.getBoundingClientRect(),t=u.getViewportSize(),n={left:e.right<0,right:e.left>t.width,top:e.bottom<0,bottom:e.top>t.height};return!(n.left||n.right||n.top||n.bottom)},isVisibleOnScreen:function(){return this.isStarted()&&!this.isEmpty()&&!this.isHidden()&&this.isInViewport()},_loadContents:function(){var n=t.defer();return this._src?r.send({url:this._getUrl(this._src),method:this._loadMethod,data:this._loadData,dataType:this._loadDataType}).then(e.bind(function(e){this._onLoaded(e),n.resolve()},this),e.bind(function(e){this._onLoadComplete(),n.reject(e)},this)).done():(this._onLoaded(),n.resolve()),n.promise},_onLoadStart:function(){this._node.setAttribute(g,!0)},_onLoadComplete:function(){this._node.removeAttribute(g)},_onLoaded:function(e){this._onLoadComplete(),this._subscribeToTopics(),this._shouldMonitorVisibility&&this._monitorVisibility(),this._render(e&&e.data)},_render:function(){},_destroy:function(){},_subscribeToTopics:function(){return this._subscribedToTopics?!1:(e.each(this._topics,function(e,t){i.subscribe(t,e)}),this._subscribedToTopics=!0,void 0)},_unsubscribeFromTopics:function(){return this._subscribedToTopics?(e.each(this._topics,function(e,t){i.unsubscribe(t,e)}),this._subscribedToTopics=!1,void 0):!1},_getUrl:function(t){return o.addParamsToQueryString(t,e.extend(this._getAttrs(),this._getParams()))},_getParams:function(){},_getAttrs:function(t){var n=(t||this._node).attributes;return e.reduce(n,e.bind(function(t,n){var i;return 0===n.name.indexOf(d)&&(i=n.name.substr(d.length),-1===e.indexOf(h,i)&&(t[o.dashSeparatedToCamelCase(i)]=this._windowObject.decodeURIComponent(n.value))),t},this),{})},_getOtherAttrs:function(t){var n=(t||this._node).attributes;return e.reduce(n,e.bind(function(e,t){return-1===t.name.indexOf(d)&&(e[o.dashSeparatedToCamelCase(t.name)]=this._windowObject.decodeURIComponent(t.value)),e},this),{})},_getAttr:function(e,t){var n=this._getAttrs(t||this._node);return n[e]||null},_setAttr:function(e,t,n){(n||this._node).setAttribute(o.camelCaseToDashSeperated(d+e),this._windowObject.decodeURIComponent(t))},_findNodesInPluginByDataAttr:function(e,t){return this._findNodesInPlugin("["+d+e+"]",t)},_findNodesInPlugin:function(e,t){return(t||this._node).querySelectorAll(e)},_insertHtml:function(e,t){this._node.innerHTML=t?e:s.xss(e||"",["form","input","textarea"])},_publish:function(){var e=Array.prototype.slice.call(arguments);e.push(this._node),i.publish.apply(i,e)},_monitorVisibility:function(){this._visibilityInterval||(this._visibilityInterval=this._windowObject.setInterval(this._boundCheckVisibility,p),a.info("Started monitoring plugin visibility",this._visibilityInterval,this))},_checkVisibility:function(){var e;this.isVisibleOnScreen()&&(e=this._node.getAttribute(d+"plugin"),a.info("Plugin seen:",e,this._node),this._stopMonitoringVisibility(),i.publishEventToGD("plugin_seen",{plugin_type:e}))},_stopMonitoringVisibility:function(){a.info("Stopping monitoring plugin visibility",this._visibilityInterval,this),this._shouldMonitorVisibility=!1,this._windowObject.clearInterval(this._visibilityInterval)},_dispatchRenderedEvent:function(){var e=this._node.getAttribute(d+"plugin");a.info("Plugin rendered:",e,this._node),i.publishEventToGD("plugin_rendered",{plugin_type:e})}},c}),n("gd-sdk/plugin/alerts",["lib/bean","lib/lodash","gd-sdk/sanitise","gd-sdk/utils","gd-sdk/animation","gd-sdk/plugin/base"],function(e,t,n,i,r,s){var o,a='<div class="gd-alerts"></div>',u=1e4;return o=function(){o._super.apply(this,arguments),this._shouldMonitorVisibility=!1,this._alertsNode=null,this._topics={"/gd/message/alert":t.bind(this._onMessage,this)}},s.extend(o,{_render:function(){this._insertHtml(a),this._alertsNode=this._node.childNodes[0],this._dispatchRenderedEvent()},_showMessage:function(e,i){var s=document.createElement("div");s.innerHTML=n.xss(e||""),s.className=n.xss(i||""),this._alertsNode.appendChild(s),this._windowObject.setTimeout(t.bind(function(){r.run(s,{opacity:0,duration:1e3}).then(t.bind(function(){this._alertsNode.removeChild(s)},this)).done()},this),u)},_onMessage:function(e){e&&e.message&&this._showMessage(e.message,e.type||null)}}),s.register("alerts",o),o}),n("gd-sdk/plugin/bar",["lib/bean","lib/lodash","gd-sdk/utils","gd-sdk/pubsub","gd-sdk/config","gd-sdk/plugin/utils","gd-sdk/metrics/environment","gd-sdk/plugin/base"],function(e,t,n,i,r,s,o,a){var u=r.sdk.attrs.prefix,l=u+"bar-items",c=function(){c._super.apply(this,arguments),this._minimiserNodes=null,this._wrapperNode=null,this._barNode=null,this._dropdownNodes=null,this._drawerTogglerNodes=null,this._drawerNodes=null,this._onClickMinimiserBound=t.bind(this._onClickMinimiser,this),this._onClickDropdownTogglerBound=t.bind(this._onClickDropdownToggler,this),this._onClickDocumentBound=t.bind(this._onClickDocument,this),this._onClickDrawerTogglerBound=t.bind(this._onClickDrawerToggler,this),this._onClickDrawerBound=t.bind(this._onClickDrawer,this),this._onMouseEnterDropdownBound=t.bind(this._onMouserEnterDropdown,this),this._onMouseLeaveDropdownBound=t.bind(this._onMouserLeaveDropdown,this),this._topics={"/gd/user/login/success":t.bind(this._onLogin,this),"/gd/user/logout":t.bind(this._onLogout,this)}};return a.extend(c,{load:function(){return this._node.hasAttribute(l)&&(this._loadMethod="post",this._loadData=this._node.getAttribute(l)),a.prototype.load.call(this)},_onLoaded:function(e){this._subscribeToTopics(),this._render(e&&e.data)},_render:function(e){this._insertHtml(e),this._wrapperNode=this._findNodesInPluginByDataAttr("bar-wrapper")[0],this._minimiserNodes=this._findNodesInPluginByDataAttr("bar-minimiser"),this._barNode=this._findNodesInPluginByDataAttr("bar")[0],this._dropdownNodes=this._findNodesInPluginByDataAttr("bar-dropdown"),this._drawerTogglerNodes=this._findNodesInPluginByDataAttr("bar-drawer-toggler"),this._drawerNodes=this._findNodesInPluginByDataAttr("bar-drawer"),s.startSome(this._findNodesInPluginByDataAttr("plugin")),this._attachEvents()},_destroy:function(){this._detachEvents()},_attachEvents:function(){this._minimiserNodes&&t.each(this._minimiserNodes,function(t){e.on(t,"click",this._onClickMinimiserBound)},this),this._dropdownNodes&&t.each(this._dropdownNodes,function(t){e.on(t,"click",this._onClickDropdownTogglerBound),t.hasAttribute(u+"bar-activate-on-hover")&&(e.on(t,"mouseenter",this._onMouseEnterDropdownBound),e.on(t,"mouseleave",this._onMouseLeaveDropdownBound))},this),this._drawerTogglerNodes&&t.each(this._drawerTogglerNodes,function(t){e.on(t,"click",this._onClickDrawerTogglerBound)},this),this._drawerNodes&&t.each(this._drawerNodes,function(t){e.on(t,"click",this._onClickDrawerBound)},this),e.on(document,"click",this._onClickDocumentBound)},_detachEvents:function(){this._minimiserNodes&&t.each(this._minimiserNodes,function(t){e.off(t,"click",this._onClickMinimiserBound)},this),this._dropdownNodes&&t.each(this._dropdownNodes,function(t){e.off(t,"click",this._onClickDropdownTogglerBound),t.hasAttribute(u+"bar-activate-on-hover")&&(e.off(t,"mouseenter",this._onMouseEnterDropdownBound),e.off(t,"mouseleave",this._onMouseLeaveDropdownBound))},this),this._drawerTogglerNodes&&t.each(this._drawerTogglerNodes,function(t){e.off(t,"click",this._onClickDrawerTogglerBound)},this),this._drawerNodes&&t.each(this._drawerNodes,function(t){e.off(t,"click",this._onClickDrawerBound)},this),e.off(document,"click",this._onClickDocumentBound)},_onLogin:function(){this._wrapperNode.setAttribute(u+"bar-logged-in",!0),this._closeAllDropDowns(),this._closeAllDrawers()},_onLogout:function(){this._wrapperNode.removeAttribute(u+"bar-logged-in"),this._closeAllDropDowns(),this._closeAllDrawers()},_onClickMinimiser:function(e){e.preventDefault(),"true"===this._getAttr("minimised")?this._maximise():this._minimise()},_minimise:function(){this._closeAllDropDowns(),this._closeAllDrawers(),this._node.setAttribute(u+"minimised",!0),this._barNode.className=this._barNode.className.replace(/(^|\s)open(\s|$)/g," ")},_maximise:function(){this._node.setAttribute(u+"minimised",!1),this._barNode.className+=" open"},_findDropdownNode:function(e){for(var t=e;t;){if(/(^|\s)dropdown(\s|$)/.test(t.className))return t;t=t.parentNode}return!1},_isInDropdown:function(e){for(var t=e;t&&t.className;){if(/(^|\s)dropdown-menu(\s|$)/.test(t.className))return!0;t=t.parentNode}return!1},_isDropdownOpen:function(e){var t=this._findDropdownNode(e);return t?/(^|\s)open(\s|$)/.test(t.className):!1
},_toggleDropdown:function(e){this._isDropdownOpen(e)?this._closeDropdown(e):this._openDropdown(e)},_openDropdown:function(e){var t,n=this._findDropdownNode(e);n&&(t=n.querySelectorAll(".dropdown-menu")[0],this._closeAllDropDowns(),this._isDropdownOpen(n)||(n.className+=" open",this._centreNodeRelativeToReferenceNode(t,n),n.className+=" gd-bar-expanded"))},_closeDropdown:function(e){var t=this._findDropdownNode(e);t&&this._isDropdownOpen(t)&&(t.className=t.className.replace(/(^|\s)open(\s|$)/g," "),t.className=t.className.replace(/(^|\s)gd-bar-expanded(\s|$)/g," "))},_closeAllDropDowns:function(){t.each(this._dropdownNodes,function(e){this._closeDropdown(e)},this)},_onClickDropdownToggler:function(e){this._isInDropdown(e.target)||(e.preventDefault(),this._toggleDropdown(e.target))},_onMouserEnterDropdown:function(e){e.preventDefault(),this._openDropdown(e.target)},_onMouserLeaveDropdown:function(e){e.preventDefault(),this._closeDropdown(e.target)},_onClickDocument:function(e){this._findDropdownNode(e.target)||this._closeAllDropDowns()},_centreNodeRelativeToReferenceNode:function(e,t){var n={w:e.clientWidth||e.offsetWidth},i={w:t.clientWidth||t.offsetWidth};e.style.marginLeft=i.w/2-n.w/2+"px",this._repositionNodeHorizontallyInBoundsOfReferenceNode(e,this._barNode)},_repositionNodeHorizontallyInBoundsOfReferenceNode:function(e,t){var n=this._getPositionOfNodeRelativeToViewPort(e),i=this._getPositionOfNodeRelativeToViewPort(t),r=n.left-i.left,s=n.right-i.right,o=parseInt(e.style.marginLeft,10)||0,a=0;return 0>r?a-=r:0>s&&(a+=s),a&&(e.style.marginLeft=o+a+"px"),a},_getPositionOfNodeRelativeToViewPort:function(e){var n=e.getBoundingClientRect(),i=o.getViewportSize();return t.extend({},n,{right:i.width-n.right,bottom:i.height-n.bottom})},_onClickDrawerToggler:function(e){e.preventDefault(),this._toggleDrawer(e.target)},_onClickDrawer:function(e){for(var t=e.target;t&&t.hasAttribute;){if(t.hasAttribute(u+"bar-drawer-close")){e.preventDefault(),this._closeDrawer(e.target);break}t=t.parentNode}},_getRelatedDrawerId:function(e){for(var t=e;t&&t.hasAttribute;){if(t.hasAttribute(u+"bar-drawer-toggler"))return t.getAttribute(u+"bar-drawer-toggler");if(t.hasAttribute(u+"bar-drawer"))return t.getAttribute(u+"bar-drawer");t=t.parentNode}return!1},_findDrawerTogglerNode:function(e){var t=this._getRelatedDrawerId(e);return this._findNodesInPlugin("["+u+'bar-drawer-toggler="'+t+'"]')[0]},_findDrawerNode:function(e){var t=this._getRelatedDrawerId(e);return this._findNodesInPlugin("["+u+'bar-drawer="'+t+'"]')[0]},_toggleDrawer:function(e){this._isDrawerOpen(e)?this._closeDrawer(e):this._openDrawer(e)},_openDrawer:function(e){var t=this._findDrawerNode(e),n=this._findDrawerTogglerNode(e);this._closeAllDrawers(),this._closeAllDropDowns(),this._isDrawerOpen(t)||(n.className+=" open",t.className+=" open",i.publishEventToGD("drawer_opened",{drawer_id:this._getRelatedDrawerId(t)}))},_closeDrawer:function(e){var t=this._findDrawerNode(e),n=this._findDrawerTogglerNode(e);this._isDrawerOpen(t)&&(n.className=n.className.replace(/(^|\s+)open(\s|$)/g," "),t.className=t.className.replace(/(^|\s+)open(\s|$)/g," "))},_isDrawerOpen:function(e){return/(^|\s)open(\s|$)/.test(this._findDrawerNode(e).className)},_closeAllDrawers:function(){t.each(this._drawerNodes,function(e){this._closeDrawer(e)},this)}}),a.register("bar",c,"/plugins/social/bar"),c}),n("gd-sdk/plugin/content-recommendations",["lib/bean","lib/lodash","lib/sha1","gd-sdk/sanitise","gd-sdk/config","gd-sdk/request","gd-sdk/utils","gd-sdk/storage","gd-sdk/pubsub","gd-sdk/plugin/base"],function(e,t,n,i,r,s,o,a,u,l){var c,d=r.sdk.attrs.prefix,h=d+"loading",g=10,p=10,f=10,m=3,_={recommendationItems:"recommendations",pagination:".gd-pagination a",currentPage:"current-page"};return c=function(){c._super.apply(this,arguments),this._page=1,this._pages=null,this._perPage=null,this._isLoadingPage=!1,this._recommendationsNode=null,this._paginationItemNodes=[],this._currentPageNode=null,this._onPaginationItemNodeClickBound=t.bind(this._onPaginationItemNodeClick,this),this._onRecommendationsNodeClickBound=t.bind(this._onRecommendationsNodeClick,this),this._topics={"/gd/user/login/success":t.bind(this._onLoginSuccess,this),"/gd/user/logout":t.bind(this._onLogout,this),"/gd/session/changed":t.bind(this._onSessionChanged,this)}},l.extend(c,{_render:function(e){var t;this._insertHtml(e),t=this._node.childNodes[0],this._recommendationsNode=this._findNodesInPluginByDataAttr(_.recommendationItems)[0],this._paginationItemNodes=this._findNodesInPlugin(_.pagination),this._currentPageNode=this._findNodesInPluginByDataAttr(_.currentPage)[0],this._page=1,this._perPage=parseInt(this._getAttr("perPage",t),10),this._pages=parseInt(this._getAttr("pages",t),10),this._updatePagination(),this._attachEvents(),this._publishRecommendationsAvaliable(),this._updateRecommendationsShown()},_getParams:function(){var e=this._getExplicitlyVisitedPages(),t=this._getIgnoredRecommendations(),n=e||t;return e&&t&&(n=n.concat(t)),n?{ignore:n.join(",")}:void 0},_destroy:function(){this._detachEvents()},_attachEvents:function(){t.each(this._paginationItemNodes,t.bind(function(t){e.on(t,"click",this._onPaginationItemNodeClickBound)},this)),e.on(this._recommendationsNode,"click",this._onRecommendationsNodeClickBound)},_detachEvents:function(){t.each(this._paginationItemNodes,t.bind(function(t){e.off(t,"click",this._onPaginationItemNodeClickBound)},this)),e.off(this._recommendationsNode,"click",this._onRecommendationsNodeClickBound)},_onLoginSuccess:function(){this.reload()},_onLogout:function(){a.setItem(a.EXPLICITLY_VISITED_PAGES,[],a.LOCAL),a.setItem(a.RECOMMENDED_PAGES,{},a.LOCAL),a.setItem(a.IGNORED_RECOMMENDATIONS,{},a.LOCAL),this.reload()},_onSessionChanged:function(){a.setItem(a.EXPLICITLY_VISITED_PAGES,[],a.LOCAL),a.setItem(a.RECOMMENDED_PAGES,{},a.LOCAL),a.setItem(a.IGNORED_RECOMMENDATIONS,{},a.LOCAL),this.reload()},_onPaginationItemNodeClick:function(e){var t=e.target.getAttribute(d+"page");e.preventDefault(),t="next"===t?this._page+1:"previous"===t?this._page-1:parseInt(t,10),this._requestPage(t,e.target.getAttribute("href"))},_onRecommendationsNodeClick:function(e){var t=this._findNodeInHierarchyWithHref(e.target);t.href&&(this._addExplicitlyVisitedPage(t.href),a.setItem(a.RECOMMENDED_PAGES,{},a.LOCAL))},_findNodeInHierarchyWithHref:function(e){for(;!e.href&&e.parentNode;)e=e.parentNode;return e},_addUrlToLocalStorageArray:function(e,t,n){var i=a.getItem(e,a.LOCAL)||[],r=this._stripAndHashUrl(t);r&&(i.push(r),i.length>n&&i.shift(),a.setItem(e,i,a.LOCAL))},_addExplicitlyVisitedPage:function(e){this._addUrlToLocalStorageArray(a.EXPLICITLY_VISITED_PAGES,e,g)},_getExplicitlyVisitedPages:function(){return a.getItem(a.EXPLICITLY_VISITED_PAGES,a.LOCAL)},_addIgnoredRecommendation:function(e){this._addUrlToLocalStorageArray(a.IGNORED_RECOMMENDATIONS,e,f)},_getIgnoredRecommendations:function(){return a.getItem(a.IGNORED_RECOMMENDATIONS,a.LOCAL)},_stripAndHashUrl:function(e){var t=/^.+\/apis\/content\/recommendations\/click\?(sessionKey=.+&)?fwd=(.+)&uid=.+$/,i=t.exec(e);return i&&i.length>0?(e=i[2],n(e)):void 0},_requestPage:function(e,n){var i,r,a;return e>=1&&e<=this._pages&&!this._isLoadingPage?(this._isLoadingPage=!0,i=(e-1)*this._perPage,r=this._perPage*e,a={start:i,end:r},this._recommendationsNode.setAttribute(h,!0),s.send({url:o.addParamsToQueryString(n,t.extend(a,this._getParams(),this._getAttrs()))}).then(t.bind(this._onPageRequestSuccess,this,e),t.bind(this._onPageRequestFailed,this)).done(),!0):!1},_onPageRequestSuccess:function(e,t){this._isLoadingPage=!1,this._recommendationsNode.innerHTML=i.xss(t.data),this._recommendationsNode.removeAttribute(h),this._recommendationsNode.scrollTop=0,this._page=e,this._updatePagination(),this._updateRecommendationsShown()},_onPageRequestFailed:function(){this._isLoadingPage=!1,this._recommendationsNode.removeAttribute(h)},_updatePagination:function(){this._currentPageNode.innerHTML=i.xss(this._page.toString()),t.each(this._paginationItemNodes,function(e){var t=e.getAttribute(d+"page");e.parentNode.className=e.parentNode.className.replace(/(^|\s)disabled(\s|$)/g," ").replace(/(^|\s)active(\s|$)/g," "),("previous"===t&&this._page<=1||"next"===t&&this._page>=this._pages)&&(e.parentNode.className+="disabled"),t===this._page&&(e.parentNode.className+="active"),e.parentNode.className=e.parentNode.className.replace(/(^\s)|(\s$)/g,"")},this)},_updateRecommendationsShown:function(){var e,n,i=a.getItem(a.RECOMMENDED_PAGES,a.LOCAL)||{},r=t.pluck(this._recommendationsNode.querySelectorAll(".gd-recommendation-action a"),"href");i=t.reduce(r,t.bind(this._incrementPageCount,this),i),e=t.keys(i).length,e>p&&(n=t.first(t.sortBy(t.pairs(i),function(e){return e[1]}),e-p),t.forEach(n,function(e){delete i[e[0]]})),a.setItem(a.RECOMMENDED_PAGES,i,a.LOCAL)},_incrementPageCount:function(e,t){var n,i=this._stripAndHashUrl(t);return i&&(n=e[i]||0,n>=m?(this._addIgnoredRecommendation(t),delete e[i]):e[i]=n+1),e},_publishRecommendationsAvaliable:function(){this._recommendationsNode.children.length&&u.publish("/gd/content_recommendations/available",this._node)}}),l.register("content-recommendations",c,"/plugins/content/recommendations"),c}),n("gd-sdk/dialog",["lib/lodash"],function(e){var t={},n={width:800,height:600,menubar:0,scrollbars:1,location:0};return t.open=function(t,i,r,s){var o;return s||(s=window),i=e.extend({},n,i||{}),o=e.reduce(i,function(e,t,n){return e+=","+n.toLowerCase()+"="+t},[]).substr(1),s.open(t,r||"_blank",o)},t.openOrReuse=function(e){var n=Array.prototype.slice.call(arguments,1);return e&&!e.closed?(e.focus(),e):t.open.apply(t,n)},t}),n("gd-sdk/plugin/login",["lib/bean","lib/lodash","gd-sdk/utils","gd-sdk/config","gd-sdk/dialog","gd-sdk/plugin/base"],function(e,t,n,i,r,s){var o,a="/apis/social/login/",u="-login",l={small:"false",popup:"true"},c=t.template('<a class="ihq-login-<%= socialNetwork %> gd-login-<%= socialNetwork %>" <% if(popup) { %>data-gd-action="click" target="_blank" <% } %>href="<%= href %>">Login with <%= socialNetwork %></a>');return o=function(){o._super.apply(this,arguments),this._linkNode=null,this._onClickBound=t.bind(this._onClick,this),this._topics={"/gd/user/login/success":t.bind(this.reload,this),"/gd/user/logout":t.bind(this.reload,this)}},s.extend(o,{_render:function(){var e=i.user.loggedIn?"":this._generateHtml();this._insertHtml(e),this._linkNode=this._findNodesInPluginByDataAttr("action")[0],this._attachEvents(),this._dispatchRenderedEvent()},_destroy:function(){this._detachEvents()},_attachEvents:function(){this._linkNode&&e.on(this._linkNode,"click",this._onClickBound)},_detachEvents:function(){this._linkNode&&e.off(this._linkNode,"click",this._onClickBound)},_onClick:function(e){e.preventDefault(),r.open(e.target.getAttribute("href"))},_generateHtml:function(){var e=t.extend({},l,this._getAttrs()),n=this._type.replace(u,""),i=encodeURIComponent(this._buildLoginApiUrl(n,e));return c({socialNetwork:n,href:i,small:"true"===e.small,popup:"true"===e.popup})},_buildLoginApiUrl:function(e,t){var i=a+e;return n.buildApiEndpointUrl(i,t)}}),t.each(["facebook","twitter","google","linked-in"],function(e){s.register(e+u,o,null,["all-login"])}),o}),n("gd-sdk/plugin/on-screen-messages",["lib/bean","lib/lodash","gd-sdk/sanitise","gd-sdk/config","gd-sdk/pubsub","gd-sdk/utils","gd-sdk/api","gd-sdk/storage","gd-sdk/plugin/utils","gd-sdk/plugin/base"],function(e,t,n,i,r,s,o,a,u,l){var c,d="temporary",h="dismissable",g="persistent",p=[d,h,g],f="append",m="prepend",_="replace",b=[f,m,_],v="inline",y="center",k="topleft",w="topright",N="bottomleft",E="bottomright",S=[v,y,k,w,N,E],x={messagesNode:".gd-on-screen-messages"},C="gd-on-screen-message-open",A="message_",I=i.sdk.attrs.prefix,T=I+"message-id",P=I+"dismiss",O=I+"opt-out",M=1e3,D=1e4,L=new RegExp("(^|\\s)"+C+"(\\s|$)","g"),R=new RegExp("^"+A),B="onScreenMessages",j=a.LOCAL,K="Do not show me this message again",H=t.template('<div class="gd-on-screen-messages" data-gd-position="<%= position %>"></div>');return c=function(){c._super.apply(this,arguments),this._messagesNode=null,this._allowedTags=[],this._behaviour=null,this._transientDuration=null,this._closeDuration=null,this._optOutLabel=null,this._insertion=null,this._transientTimeouts={},this._boundMarkMessageAsOpenPartials={},this._boundRemoveMessageNodePartials={},this._boundOnMessageClick=t.bind(this._onMessageClick,this),this._boundOnMessageMouseEnter=t.bind(this._onMessageMouseEnter,this),this._boundOnMessageMouseLeave=t.bind(this._onMessageMouseLeave,this),this._boundOnMessage=t.bind(this._onMessage,this),this._boundOnDismiss=t.bind(this._onDismiss,this),this._boundOnLogin=t.bind(this._onLogin,this),this._boundOnLogout=t.bind(this._onLogout,this),this._topics={"/gd/message/onscreen":this._boundOnMessage,"/gd/message/onscreen/dismiss":this._boundOnDismiss,"/gd/user/login/success":this._boundOnLogin,"/gd/user/logout":this._boundOnLogout}},c.ON_SCREEN_MESSAGES_STORAGE_KEY=B,l.extend(c,{_render:function(){this._resolveSettings(),this._insertHtml(this._generateHtml()),this._messagesNode=this._findNodesInPlugin(x.messagesNode)[0],this._attachEvents(),this._behaviour===g&&this._reinstateMessagesFromStorage(),this._dispatchRenderedEvent()},_resolveSettings:function(){this._allowedTags=t.without(t.map((this._getAttr("categories")||"").split(","),this._trimTag),""),this._transientDuration=this._getAttr("duration")||D,this._closeDuration=this._getAttr("closeDuration")||M,this._optOutLabel=this._getAttr("optOutLabel")||K,this._behaviour=this._getAttr("behaviour"),t.contains(p,this._behaviour)||(this._behaviour=h),this._position=this._getAttr("position"),t.contains(S,this._position)||(this._position=w),this._insertion=this._getAttr("insertion"),t.contains(b,this._insertion)||(this._insertion=f)},_destroy:function(){this._detachEvents()},_attachEvents:function(){e.on(this._messagesNode,"click",this._boundOnMessageClick)},_detachEvents:function(){e.off(this._messagesNode,"click",this._boundOnMessageClick)},_attachMessageEvents:function(t){e.on(t,"mouseenter",this._boundOnMessageMouseEnter),e.on(t,"mouseleave",this._boundOnMessageMouseLeave)},_detachMessageEvents:function(t){e.off(t,"mouseenter",this._boundOnMessageMouseEnter),e.off(t,"mouseleave",this._boundOnMessageMouseLeave)},_trimTag:function(e){return e.replace(/(^\s+|\s+$)/g,"")},_showMessage:function(e,n,i,r){var s=this._constructMessageNode(e,n,i,r);this._insertion===m?this._messagesNode.firstChild?this._messagesNode.insertBefore(s,this._messagesNode.firstChild):this._messagesNode.appendChild(s):this._insertion===f?this._messagesNode.appendChild(s):this._insertion===_&&(this._messagesNode.firstChild?this._messagesNode.replaceChild(s,this._messagesNode.firstChild):this._messagesNode.appendChild(s)),u.startSome(this._findNodesInPluginByDataAttr("plugin")),this._boundMarkMessageAsOpenPartials[n]=t.bind(this._markMessageOpen,this,s),this._windowObject.setTimeout(this._boundMarkMessageAsOpenPartials[n],0),this._startTransientTimeout(n),this._attachMessageEvents(s)},_constructMessageNode:function(e,i,r,s){var o=document.createElement("div"),a=document.createElement("button"),u=document.createElement("div"),l=document.createElement("label"),c=document.createElement("input");return i=A+n.xss(i),o.setAttribute(T,i),o.className="gd-on-screen-message",t.each(s||[],function(e){o.className+=" "+e}),a.appendChild(document.createTextNode("x")),a.setAttribute(P,i),a.className="close",a.type="button",u.className="gd-on-screen-message-content",u.innerHTML=n.xss(e),c.type="checkbox",c.setAttribute(O,i),l.appendChild(c),l.appendChild(document.createTextNode(n.xss(this._optOutLabel))),o.appendChild(a),o.appendChild(u),this._getUserKey()&&r&&o.appendChild(l),o},_closeMessage:function(e){var n=this._findNodesInPlugin("["+T+'="'+A+e+'"]');t.each(n,function(n){this._clearTransientTimeout(e),this._markMessageClosed(n),this._boundRemoveMessageNodePartials[e]=t.bind(this._removeMessageNode,this,n),this._windowObject.setTimeout(this._boundRemoveMessageNodePartials[e],this._closeDuration)},this)},_removeMessageNode:function(e){this._detachMessageEvents(e),e.parentNode.removeChild(e)},_markMessageOpen:function(e){e.className=e.className+" "+C},_markMessageClosed:function(e){e.className=e.className.replace(L," ")},_onMessageClick:function(e){var t,n=this._findMessageIdFromNode(e.target);e.target.hasAttribute(P)&&n&&(t=this._node.querySelector("["+T+'="'+A+n+'"] input[type=checkbox]['+O+"]"),t&&t.checked&&o.post({url:"/apis/behaviour/onscreen/message/optout",dataType:"application/json",data:{message_id:n,opt_out:!0}}),this._dismiss(n))},_onMessageMouseEnter:function(e){var t=e.currentTarget.getAttribute(T);t&&(t=t.replace(R,""),this._clearTransientTimeout(t))},_onMessageMouseLeave:function(e){var t=e.currentTarget.getAttribute(T);t&&(t=t.replace(R,""),this._startTransientTimeout(t))},_startTransientTimeout:function(e){this._behaviour===d&&(this._transientTimeouts[e]=this._windowObject.setTimeout(t.bind(this._dismiss,this,e),this._transientDuration))},_clearTransientTimeout:function(e){this._transientTimeouts[e]&&(this._windowObject.clearTimeout(this._transientTimeouts[e]),delete this._transientTimeouts[e])},_onMessage:function(e){e&&e.body&&e.id&&this._allowMessage(e.tags)&&(this._showMessage(e.body,e.id,e.allowOptOut,e.tags),this._behaviour===g&&this._storeMessage(e))},_onDismiss:function(e){this._closeMessage(e),this._behaviour===g&&this._unStoreMessage(e)},_dismiss:function(e){r.publish("/gd/message/onscreen/dismiss",e)},_allowMessage:function(e){var n=!1;return this._allowedTags.length?this._allowedTags.length&&t.each(e||[],function(e){n||(n=t.contains(this._allowedTags,this._trimTag(e)))},this):n=!0,(!t.isArray(e)||t.isArray(e)&&!e.length)&&(n=!0),n},_findMessageIdFromNode:function(e){for(var t=e;t;){if(t.hasAttribute(T))return t.getAttribute(T).replace(R,"");t=t.parentNode}return!1},_storeMessage:function(e){var t=i.sdk.storage.userDataKey,n=this._getUserKey();e.at=e.at||s.now(),n&&a.setItem(t+"."+n+"."+c.ON_SCREEN_MESSAGES_STORAGE_KEY+"."+e.id,e,j)},_unStoreMessage:function(e){var t=i.sdk.storage.userDataKey,n=this._getUserKey();n&&a.removeItem(t+"."+n+"."+c.ON_SCREEN_MESSAGES_STORAGE_KEY+"."+e,j)},_onLogin:function(){this._behaviour===g&&this._reinstateMessagesFromStorage()},_onLogout:function(){var e=this._findNodesInPlugin("["+T+"]");t.each(e,this._removeMessageNode,this)},_reinstateMessagesFromStorage:function(){var e,n=i.sdk.storage.userDataKey,r=this._getUserKey();r&&(e=a.getItem(n+"."+r+"."+c.ON_SCREEN_MESSAGES_STORAGE_KEY,j),e=t.values(e).sort(function(e,t){return e.at<t.at?-1:e.at>t.at?1:0}),t.each(e,function(e){this._showMessage(e.body,e.id,e.allowOptOut,e.tags,e.at)},this))},_getUserKey:function(){return i.user&&i.user.info&&i.user.info.key?i.user.info.key:void 0},_generateHtml:function(){return H({position:this._position})}}),l.register("on-screen-messages",c,null),c}),n("gd-sdk/plugin/personal-share",["lib/bean","lib/lodash","gd-sdk/config","gd-sdk/dialog","gd-sdk/pubsub","gd-sdk/request","gd-sdk/utils","gd-sdk/plugin/base"],function(e,t,n,i,r,s,o,a){var u=function(){u._super.apply(this,arguments),this._linkNode=null,this._lastDialog=null,this._onClickBound=t.bind(this._onClick,this),this._onMessageBound=t.bind(this._onMessage,this),this._topics={"/gd/user/login/success":t.bind(this.reload,this),"/gd/user/logout":t.bind(this.reload,this)}};return a.extend(u,{_render:function(e){this._insertHtml(e),this._linkNode=this._findNodesInPluginByDataAttr("action")[0],this._attachEvents()},_destroy:function(){this._detachEvents()},_attachEvents:function(){this._linkNode&&e.on(this._linkNode,"click",this._onClickBound),e.on(window,"message",this._onMessageBound)},_detachEvents:function(){this._linkNode&&e.off(this._linkNode,"click",this._onClickBound),e.off(window,"message",this._onMessageBound)},_onClick:function(e){e.preventDefault(),e.stopPropagation(),this._lastDialog&&this._lastDialog.close(),this._lastDialog=i.open(e.target.getAttribute("href"))},_onMessage:function(e){var t;return e.originalEvent.data.match(/tweet/)&&e.source===this._lastDialog?(t=this._linkNode.parentNode.getAttribute("data-url"),r.publish("/gd/social_recommendation/twitter/success",t),s.send({url:o.interpolate(n.api.personalSharedCallbackPath,{network:"twitter",url:encodeURIComponent(t)})}).then(function(e){r.publishEventsFromJson(e.data)}).done(),void 0):!1}}),t.each(["facebook","twitter","linked-in"],function(e){a.register(e+"-personal-share",u,"/plugins/social/personal/"+e,["all-personal-share"])}),u}),n("gd-sdk/plugin/relevance-feedback",["lib/bean","lib/lodash","gd-sdk/utils","gd-sdk/config","gd-sdk/api","gd-sdk/pubsub","gd-sdk/plugin/base"],function(e,t,n,i,r,s,o){var a,u=i.sdk.attrs.prefix,l="/apis/relevance/feedback";return a=function(){a._super.apply(this,arguments),this._feedbackNodes=null,this._onClickFeedbackBound=t.bind(this._onClickFeedback,this),this._boundOnFeedbackChange=t.bind(this._onFeedbackChange,this),this._topics={"/gd/user/login/success":t.bind(this.reload,this),"/gd/user/logout":t.bind(this.reload,this),"/gd/relevance_feedback/feedback":this._boundOnFeedbackChange}},o.extend(a,{_render:function(e){this._insertHtml(e),this._feedbackNodes=this._findNodesInPluginByDataAttr("relevance-feedback"),this._attachEvents()},_destroy:function(){this._detachEvents()},_attachEvents:function(){this._feedbackNodes&&t.each(this._feedbackNodes,function(t){e.on(t,"click",this._onClickFeedbackBound)},this)},_detachEvents:function(){this._feedbackNodes&&t.each(this._feedbackNodes,function(t){e.off(t,"click",this._onClickFeedbackBound)},this)},_onClickFeedback:function(e){var n=e.target.getAttribute(u+"relevance-feedback");e.preventDefault(),r.post({url:l,data:{relevance_type:n,url:this._getRelevantUrl()}}).then(t.bind(this._onFeedbackRecieved,this,n)).done()},_onFeedbackRecieved:function(e,t){this._showRelevance(e),this._publish("/gd/relevance_feedback/feedback",{url:this._getRelevantUrl(),relevance:e}),s.publishEventsFromJson(t)},_showRelevance:function(e){var n=u+"selected";t.each(this._feedbackNodes,function(t){t.className=t.className.replace(/(^|\s)disabled(\s|$)/g," "),t.hasAttribute(n)&&t.removeAttribute(n),t.getAttribute(u+"relevance-feedback")===e&&(t.setAttribute(n,!0),t.className+=" disabled")})},_onFeedbackChange:function(e){e.url===this._getRelevantUrl()&&this._showRelevance(e.relevance)},_getRelevantUrl:function(){return this._getAttr("url")||location.href}}),o.register("relevance-feedback",a,"/plugins/relevance/feedback"),a}),n("gd-sdk/plugin/social-recommendations",["lib/bean","lib/lodash","gd-sdk/sanitise","gd-sdk/config","gd-sdk/dialog","gd-sdk/pubsub","gd-sdk/utils","gd-sdk/plugin/base"],function(e,t,n,i,r,s,o,a){var u,l=i.sdk.attrs.prefix,c=l+"friend-name",d=l+"relevant",h="gd-recommendation-context-active",g={recommendationItem:".recommendation-item",recommendationItemInput:".recommendation-item input",recommendationItemInputChecked:'.recommendation-item input[type="checkbox"]:checked',recommendationItemContext:".gd-recommendation-context",pagination:".gd-pagination",contextExplanation:".gd-recommendation-context-explanation"},p=new RegExp("(^|\\s)"+h+"(\\s|$)","g");return u=function(){u._super.apply(this,arguments),this._resultSet=null,this._page=null,this._pages=null,this._searchQuery="",this._multiselect=null,this._multiselectUrl=null,this._perPage=null,this._searchNode=null,this._searchFormNode=null,this._selectAllNode=null,this._itemNodes=[],this._itemSelectNodes=[],this._itemLinkNodes=[],this._selectAllSubmitNode=null,this._contextExplanationNode=null,this._paginationNode=null,this._paginationItemNodes=[],this._lastLink=null,this._lastDialog=null,this._onSearchQueryChangeBound=t.bind(this._onSearchQueryChange,this),this._onActionClickBound=t.bind(this._onActionClick,this),this._onMessageBound=t.bind(this._onMessage,this),this._onPaginationItemNodeClickBound=t.bind(this._onPaginationItemNodeClick,this),this._onSelectAllChangeBound=t.bind(this._onSelectAllChange,this),this._onCheckboxChangeBound=t.bind(this._onCheckboxChange,this),this._onSelectAllSubmitBound=t.bind(this._onSelectAllSubmit,this),this._onSearchFormSubmitBound=t.bind(this._onSearchFormSubmit,this),this._onRecommendationMouseEnterBound=t.bind(this._onRecommendationMouseEnter,this),this._onRecommendationMouseLeaveBound=t.bind(this._onRecommendationMouseLeave,this),this._topics={"/gd/user/login/success":t.bind(this.reload,this),"/gd/user/logout":t.bind(this.reload,this)}},a.extend(u,{_render:function(e){var t;this._insertHtml(e),t=this._node.childNodes[0],this._multiselect=null!==this._getAttr("multiselect",t),this._multiselectUrl=this._getAttr("multiselectUrl",t),this._perPage=parseInt(this._getAttr("perPage",t),10),this._searchNode=this._findNodesInPluginByDataAttr("search")[0],this._searchFormNode=this._findNodesInPluginByDataAttr("search-form")[0],this._selectAllNode=this._findNodesInPluginByDataAttr("select-all")[0],this._itemNodes=this._findNodesInPlugin(g.recommendationItem),this._itemLinkNodes=this._findNodesInPluginByDataAttr("social-popup"),this._itemSelectNodes=this._findNodesInPlugin(g.recommendationItemInput),this._selectAllSubmitNode=this._findNodesInPluginByDataAttr("submit-multiple")[0],this._paginationNode=this._findNodesInPlugin(g.pagination)[0],this._contextExplanationNode=this._findNodesInPlugin(g.contextExplanation)[0],this._attachEvents(),this._buildResultSet(),this._goToPage(1)},_destroy:function(){this._detachEvents()},_attachEvents:function(){this._searchNode&&(e.on(this._searchNode,"keyup",this._onSearchQueryChangeBound),e.on(this._searchNode,"search",this._onSearchQueryChangeBound),e.on(this._searchNode.form,"submit",this._onSearchFormSubmitBound)),this._searchFormNode&&e.on(this._searchFormNode,"submit",this._onSearchFormSubmitBound),this._selectAllNode&&e.on(this._selectAllNode,"change",this._onSelectAllChangeBound),t.each(this._itemLinkNodes,t.bind(function(t){e.on(t,"click",this._onActionClickBound)},this)),t.each(this._itemSelectNodes,t.bind(function(t){e.on(t,"change",this._onCheckboxChangeBound)},this)),this._selectAllSubmitNode&&e.on(this._selectAllSubmitNode,"click",this._onSelectAllSubmitBound),t.each(this._itemNodes,function(t){e.on(t,"mouseenter",this._onRecommendationMouseEnterBound),e.on(t,"mouseleave",this._onRecommendationMouseLeaveBound)},this)},_detachEvents:function(){this._searchNode&&(e.off(this._searchNode,"keyup",this._onSearchQueryChangeBound),e.off(this._searchNode,"search",this._onSearchQueryChangeBound),e.off(this._searchNode.form,"submit",this._onSearchFormSubmitBound)),this._searchFormNode&&e.off(this._searchFormNode,"submit",this._onSearchFormSubmitBound),this._selectAllNode&&e.off(this._selectAllNode,"change",this._onSelectAllChangeBound),t.each(this._itemLinkNodes,t.bind(function(t){e.off(t,"click",this._onActionClickBound)},this)),t.each(this._itemSelectNodes,t.bind(function(t){e.off(t,"change",this._onCheckboxChangeBound)},this)),this._selectAllSubmitNode&&e.off(this._selectAllSubmitNode,"click",this._onSelectAllSubmitBound),t.each(this._itemNodes,function(t){e.off(t,"mouseenter",this._onRecommendationMouseEnterBound),e.off(t,"mouseleave",this._onRecommendationMouseLeaveBound)},this)},_attachPaginationEvents:function(){t.each(this._paginationItemNodes,t.bind(function(t){e.on(t,"click",this._onPaginationItemNodeClickBound)},this))},_detachPaginationEvents:function(){t.each(this._paginationItemNodes,t.bind(function(t){e.off(t,"click",this._onPaginationItemNodeClickBound)},this))},_markContextNodeAsActive:function(e){e.className+=" "+h,this._contextExplanationNode&&(this._contextExplanationNode.className=this._contextExplanationNode.className.replace(p," "))},_markAllContextNodesAsNotActive:function(){t.each(this._itemNodes,function(e){var t=e.querySelector(g.recommendationItemContext);t&&(t.className=t.className.replace(p," "))},this),this._contextExplanationNode&&-1===this._contextExplanationNode.className.indexOf(h)&&(this._contextExplanationNode.className+=" "+h)},_findParentRecommendationItemNode:function(e){for(;e&&!e.hasAttribute(c);)e=e.parentNode;return e||!1},_onRecommendationMouseEnter:function(e){var t,n=this._findParentRecommendationItemNode(e.target);this._markAllContextNodesAsNotActive(),n&&(t=n.querySelector(g.recommendationItemContext),t&&this._markContextNodeAsActive(t))},_onRecommendationMouseLeave:function(){this._markAllContextNodesAsNotActive()},_onSearchQueryChange:function(e){this._searchQuery=e.target.value,this._buildResultSet(),this._goToPage(1)},_onSearchFormSubmit:function(e){e.preventDefault()},_onActionClick:function(e){e.preventDefault(),e.stopPropagation(),this._lastDialog&&this._lastDialog.close(),this._lastLink=e.target,this._lastDialog=r.open(e.target.getAttribute("href")),s.publish("/gd/social_recommendations/success",1)},_onMessage:function(e){var t;return e.originalEvent.data.match(/tweet/)&&e.source===this._lastDialog&&this._lastLink?(t=this._lastLink.parentNode.getAttribute("data-url"),s.publish("/gd/social_recommendation/twitter/success",t),void 0):!1},_onPaginationItemNodeClick:function(e){var t=e.target;e.preventDefault(),t=e.target.getAttribute(l+"page"),t="next"===t?this._page+1:"previous"===t?this._page-1:parseInt(t,10),this._goToPage(t)},_onSelectAllChange:function(e){var n=e.target.checked,i=this._checkboxesInResultSet();t.each(i,t.bind(function(e){e.checked=n},this))},_onCheckboxChange:function(){this._setSelectAllState()},_onSelectAllSubmit:function(e){var n=this._findNodesInPlugin(g.recommendationItemInputChecked),i=(this._getAttr("facebookEventId"),this._multiselectUrl);e.preventDefault(),n.length>0&&(i+="&"+t.map(n,function(e){return"to="+e.getAttribute("value")}),r.open(i),s.publish("/gd/social_recommendations/success",n.length))},_goToPage:function(e){var n,i;return 1>e||e>this._pages?!1:(this._page=e,n=(this._page-1)*this._perPage,i=this._perPage*this._page,t.each(this._itemNodes,function(e){e.setAttribute(l+"hidden",!0)}),t.each(this._resultSet.slice(n,i),function(e){e.removeAttribute(l+"hidden")}),this._buildPagination(),this._multiselect&&this._setSelectAllState(),void 0)},_buildResultSet:function(){this._resultSet=""===this._searchQuery?t.filter(this._itemNodes,function(e){return e.hasAttribute(d)}):t.filter(this._itemNodes,t.bind(function(e){return o.contains(e.getAttribute(c),this._searchQuery)},this)),this._pages=Math.max(Math.ceil(this._resultSet.length/this._perPage),1)},_buildPagination:function(){var e=t.range(1,(this._pages||1)+1),i=document.createElement("ul");e=[["previous","&lt;"],["next","&gt;"]],this._detachPaginationEvents(),this._paginationNode&&(this._paginationNode.innerHTML=n.xss("<span>Page <span>"+this._page+"</span> of <span>"+this._pages+"</span></span>"),this._paginationItemNodes=t.map(e,t.bind(function(e){var t=e[0],r=e[1],s=document.createElement("li"),o=document.createElement("a");return("previous"===t&&this._page<=1||"next"===t&&this._page>=this._pages)&&(s.className="disabled"),o.setAttribute(l+"page",n.xss(t)),o.innerHTML=n.xss(r),t===this._page&&(s.className="active"),s.appendChild(o),i.appendChild(s),o},this)),this._paginationNode.appendChild(i),this._attachPaginationEvents())},_checkboxesInResultSet:function(){return t.reduce(this._resultSet,t.bind(function(e,t){var n=this._findNodesInPlugin('input[type="checkbox"]',t)[0];return n&&e.push(n),e},this),[])},_setSelectAllState:function(){var e=this._checkboxesInResultSet();this._selectAllNode.checked=t.every(e,function(e){return e.checked})}}),a.register("social-recommendations",u,"/plugins/recommendations/social"),u}),n("gd-sdk/plugin/user-status",["lib/bean","lib/lodash","gd-sdk/config","gd-sdk/dialog","gd-sdk/pubsub","gd-sdk/request","gd-sdk/utils","gd-sdk/plugin/base"],function(e,t,n,i,r,s,o,a){var u,l="/apis/social/logout",c="/apis/social/profile",d="/css/img/default-avatar.gif",h=t.template('<div class="gd-user-status media"><% if (!!avatar_url) { %><div class="pull-left gd-figure gd-user-status-avatar"><img src="<%= avatar_url %>" alt="Avatar for <%= first_name %> <%= last_name %>." /></div><% } %><div class="media-body"><h4 class="media-heading"><%= first_name %> <%= last_name %></h4><div class="gd-user-status-logout"><a href="<%= logoutUrl %>" class="btn btn-primary">Logout</a></div><div class="gd-user-status-edit"><a href="<%= editUrl %>" class="btn">Settings</a></div></div></div>');
return u=function(){u._super.apply(this,arguments),this._logoutNode=null,this._editNode=null,this._lastDialog=null,this._onClickLogoutBound=t.bind(this._onClickLogout,this),this._onClickEditBound=t.bind(this._onClickEdit,this),this._topics={"/gd/user/login/success":t.bind(this.reload,this),"/gd/user/logout":t.bind(this.reload,this),"/gd/user/edited":t.bind(this.reload,this)}},a.extend(u,{_render:function(){var e=n.user.loggedIn?this._generateHtml():"";this._insertHtml(e),this._logoutNode=this._findNodesInPlugin(".gd-user-status-logout a")[0],this._editNode=this._findNodesInPlugin(".gd-user-status-edit a")[0],this._attachEvents(),this._dispatchRenderedEvent()},_destroy:function(){this._detachEvents()},_attachEvents:function(){this._logoutNode&&e.on(this._logoutNode,"click",this._onClickLogoutBound),this._editNode&&e.on(this._editNode,"click",this._onClickEditBound)},_detachEvents:function(){this._logoutNode&&e.off(this._logoutNode,"click",this._onClickLogoutBound),this._editNode&&e.off(this._editNode,"click",this._onClickEditBound)},_onClickLogout:function(e){e.preventDefault(),s.send({url:e.target.getAttribute("href")}).then(function(e){r.publishEventsFromJson(JSON.parse(e.data).events)}).done()},_onClickEdit:function(e){e.preventDefault(),this._lastDialog&&this._lastDialog.close(),this._lastDialog=i.open(e.target.getAttribute("href"))},_generateHtml:function(){var e=t.extend({},n.user.info,{logoutUrl:encodeURIComponent(o.buildApiEndpointUrl(l)),editUrl:encodeURIComponent(o.buildApiEndpointUrl(c))});return e.avatar_url||(e.avatar_url=d),h(e)}}),a.register("user-status",u,null,["all-login"]),u}),n("gd-sdk/plugin/welcome",["lib/bean","lib/lodash","lib/p","gd-sdk/config","gd-sdk/pubsub","gd-sdk/plugin/base","gd-sdk/plugin/utils","gd-sdk/utils"],function(e,t,n,i,r,s,o,a){var u,l=i.sdk.attrs.prefix,c=["maxTimesToShow"],d={title:"Welcome! Check this out:",subtitle:"",count:1,minResults:1,maxResults:1},h=t.template('<div class="ihq-welcome-recommendation" data-gd-plugin="content-recommendations" <%=proxiedAttrs%>></div>');return u=function(){u._super.apply(this,arguments),this._boundOnScreenMessagesPluginLoaded=t.bind(this._onScreenMessagesPluginLoaded,this),this._topics={"/gd/user/login/success":t.bind(this.reload,this),"/gd/user/logout":t.bind(this.reload,this),"/gd/content_recommendations/available":t.bind(this._onRecommendationsAvailable,this)}},s.extend(u,{_render:function(e){var t;return null===e||""===e?!1:(this._insertHtml(e),t=o.startSome(this._findNodesInPluginByDataAttr("plugin"))[0],t.then(this._boundOnScreenMessagesPluginLoaded),void 0)},_onScreenMessagesPluginLoaded:function(){r.publish("/gd/message/onscreen",{id:"welcome-"+ +new Date,body:h({proxiedAttrs:this._getAttributesToProxy()}),allowOptOut:!1,tags:["welcome"]})},_getAttributesToProxy:function(){var e=t.extend(d,this._getAttrs());return t.reduce(e,function(e,n,i){return t.contains(c,i)?e:e+l+a.camelCaseToDashSeperated(i)+'="'+n+'" '},"")},_onRecommendationsAvailable:function(e){var t=this._findNodesInPlugin(".ihq-welcome-recommendation")[0];e===t&&this._node.firstChild.removeAttribute(l+"hidden")}}),s.register("welcome",u,"/plugins/content/welcome"),u}),n("gd-sdk/plugin/share/email",["lib/bean","lib/lodash","gd-sdk/config","gd-sdk/pubsub","gd-sdk/request","gd-sdk/utils","gd-sdk/plugin/base"],function(e,t,n,i,r,s,o){var a,u={emailSubject:"",emailBody:""},l=t.template('<a class="btn btn-default btn-small gd-public-share-email" data-url="<%= emailUrl %>" href="mailto:?subject=<%= emailSubject %>&amp;body=<%= emailBody %> <%= emailUrl %>" target="_blank"><i class="icon-envelope"></i> Share via email</a>');return a=function(){a._super.apply(this,arguments),this._emailShareLinkNode=null,this._onClickBound=t.bind(this._onClick,this)},o.extend(a,{_render:function(){var e=this._generateHtml();this._insertHtml(e),this._emailShareLinkNode=this._node.childNodes[0],this._attachEvents(),this._dispatchRenderedEvent()},_destroy:function(){this._detachEvents()},_generateHtml:function(){var e=t.extend({},u,this._getAttrs());return e.emailUrl=e.emailUrl||e.url||s.originWithPath(),l(e)},_attachEvents:function(){this._emailShareLinkNode&&e.on(this._emailShareLinkNode,"click",this._onClickBound)},_detachEvents:function(){this._emailShareLinkNode&&e.off(this._emailShareLinkNode,"click",this._onClickBound)},_onClick:function(e){var t=s.interpolate(n.api.publicSharedCallbackPath,{network:"email",url:encodeURIComponent(e.target.getAttribute("data-url"))});r.send({url:t}).then(function(e){i.publishEventsFromJson(e.data)}).done()}}),o.register("email-share",a),o.register("email-public-share",a),a}),n("gd-sdk/plugin/share/utils",["lib/bean","lib/lodash","gd-sdk/config","gd-sdk/pubsub","gd-sdk/request","gd-sdk/utils"],function(e,t,n,i,r,s){return{reportShare:function(e,t){r.send({url:s.interpolate(n.api.publicSharedCallbackPath,{network:e,url:encodeURIComponent(t)})}).then(function(e){i.publishEventsFromJson(e.data)}).done(),i.publish("/gd/shared",{type:e,url:t})}}}),n("gd-sdk/lib/facebook-sdk",["lib/p","gd-sdk/utils","gd-sdk/plugin/share/utils"],function(e,t,n){var i,r={},s="https://connect.facebook.net/en_GB/sdk.js";return r.load=function(){if(!i){if(i=e.defer(),window.FB)return r._onLoad(),i.promise;window.fbAsyncInit=r._onLoad,t.loadExternalJs(s,"facebook-jssdk")}return i.promise},r._onLoad=function(){window.FB.init({version:"v1.0"}),window.FB.Event.subscribe("edge.create",function(e){n.reportShare("facebook",e)}),i.resolve(window.FB)},r}),n("gd-sdk/plugin/share/_restylable",["lib/bean","lib/lodash","gd-sdk/dialog","gd-sdk/plugin/share/utils"],function(e,t,n,i){var r,s=t.template('<a class="ihq-share-<%= type %>" data-type="<%- type %>" data-url="<%- rawUrl %>" href="<%- url %>">Share</a>');return r=function(){this._lastDialog=null,this._shareLinkNode=null,this._onClickBound=t.bind(this._onClick,this)},r.prototype={useNetworkButton:function(e){return"false"!==e},attachEvents:function(t){t&&e.on(t,"click",this._onClickBound)},detachEvents:function(t){t&&e.off(t,"click",this._onClickBound)},generateHtml:function(e,t,n){return s({type:e,url:t,rawUrl:n})},_onClick:function(e){e.preventDefault(),this._lastDialog=n.openOrReuse(this._lastDialog,e.target.getAttribute("href")),i.reportShare(e.target.getAttribute("data-type"),e.target.getAttribute("data-url"))}},r}),n("gd-sdk/plugin/share/facebook",["lib/bean","lib/lodash","gd-sdk/utils","gd-sdk/lib/facebook-sdk","gd-sdk/plugin/base","gd-sdk/plugin/share/_restylable"],function(e,t,n,i,r,s){var o,a="https://www.facebook.com/sharer/sharer.php?u=",u=t.template('<div class="ihq-share-facebook gd-public-share-facebook fb-like" data-layout="button_count" data-href="<%= fbUrl %>" <%= extraAttrs %>></div>');return o=function(){o._super.apply(this,arguments),this._restylableShare=new s,this._shareLinkNode=null},r.extend(o,{_render:function(){var e=this._generateHtml();this._insertHtml(e),this._useNetworkButton()?i.load().then(t.bind(this._facebookSdkLoaded,this)).done():(this._shareLinkNode=this._node.childNodes[0],this._restylableShare.attachEvents(this._shareLinkNode)),this._dispatchRenderedEvent()},_destroy:function(){this._restylableShare.detachEvents(this._shareLinkNode)},_generateHtml:function(){var e=this._getAttrs();return e.fbUrl=e.fbUrl||e.url||n.originWithPath(),this._useNetworkButton()?(e.extraAttrs=n.attrsToHtml(this._getOtherAttrs()),u(e)):this._restylableShare.generateHtml("facebook",a+e.fbUrl,e.fbUrl)},_facebookSdkLoaded:function(e){e.XFBML.parse()},_useNetworkButton:function(){return this._restylableShare.useNetworkButton(this._getAttr("useNetworkButton"))}}),r.register("facebook-share",o,null,["all-share"]),r.register("facebook-public-share",o,null,["all-public-share"]),o}),n("gd-sdk/lib/google-sdk",["lib/p","gd-sdk/utils","gd-sdk/plugin/share/utils"],function(e,t,n){var i,r={},s="https://apis.google.com/js/platform.js";return r.load=function(){if(!i){if(i=e.defer(),window.gapi&&window.gapi.plusone)return i.resolve(window.gapi),i.promise;window.___gcfg={parsetags:"explicit"},t.loadExternalJs(s,"google-jssdk").then(function(){i.resolve(window.gapi)})}return i.promise},r.onPlusOne=function(e,t){"on"===t.state&&n.reportShare("google",e)},r}),n("gd-sdk/plugin/share/google",["lib/bean","lib/lodash","gd-sdk/utils","gd-sdk/lib/google-sdk","gd-sdk/plugin/base","gd-sdk/plugin/share/_restylable"],function(e,t,n,i,r,s){var o,a="https://plus.google.com/share?url=",u=t.template('<div class="g-plusone" data-href="<%= gUrl %>" <%= extraAttrs %>"></div>');return o=function(){o._super.apply(this,arguments),this._googlePlusOneCallback=null,this._restylableShare=new s,this._shareLinkNode=null},r.extend(o,{_render:function(){var e=this._generateHtml();this._insertHtml(e),this._useNetworkButton()?i.load().then(t.bind(this._googleSdkLoaded,this)).done():(this._shareLinkNode=this._node.childNodes[0],this._restylableShare.attachEvents(this._shareLinkNode)),this._dispatchRenderedEvent()},_destroy:function(){this._restylableShare.detachEvents(this._shareLinkNode)},_generateHtml:function(){var e=this._getAttrs();return e.gUrl=e.gUrl||e.url||n.originWithPath(),this._useNetworkButton()?(e.extraAttrs=n.attrsToHtml(this._getOtherAttrs()),u(e)):this._restylableShare.generateHtml("google",a+e.gUrl,e.gUrl)},_googleSdkLoaded:function(e){var r=this._node.childNodes[0];return r?(this._googlePlusOneCallback="googlePlusOneCallback"+n.uuid().replace(/-/g,""),this._windowObject[this._googlePlusOneCallback]=t.partial(i.onPlusOne,r.getAttribute("data-href")),r.setAttribute("data-callback",this._googlePlusOneCallback),e.plusone.go(this._node),void 0):!1},_useNetworkButton:function(){return this._restylableShare.useNetworkButton(this._getAttr("useNetworkButton"))}}),r.register("google-share",o,null,["all-share"]),r.register("google-plus-one-public-share",o,null,["all-public-share"]),o}),n("gd-sdk/lib/linked-in-sdk",["lib/p","gd-sdk/utils","gd-sdk/plugin/share/utils"],function(e,t,n){var i,r={},s="https://platform.linkedin.com/in.js?async=true";return r.load=function(){var n="linkedInSdkInitCallback"+t.uuid();if(!i){if(i=e.defer(),window.IN&&"function"==typeof window.IN.parse)return i.resolve(window.IN),void 0;window[n]=function(){i.resolve(window.IN)},t.loadExternalJs(s,"linked-in-js-sdk").then(function(){window.IN.init({onLoad:n})},function(){i.reject()}).done()}return i.promise},r.onShare=function(e){n.reportShare("linked-in",e)},r}),n("gd-sdk/plugin/share/linked-in",["lib/bean","lib/lodash","gd-sdk/utils","gd-sdk/lib/linked-in-sdk","gd-sdk/plugin/base","gd-sdk/plugin/share/_restylable"],function(e,t,n,i,r,s){var o,a="https://www.linkedin.com/shareArticle?url=",u=t.template('<div type="IN/Share" data-showzero="true" data-counter="right" data-url="<%= liUrl %>" <%= extraAttrs %>></div>');return o=function(){o._super.apply(this,arguments),this._linkedInCallback=null,this._restylableShare=new s,this._shareLinkNode=null},r.extend(o,{_render:function(){var e=this._generateHtml();this._insertHtml(e),this._useNetworkButton()?i.load().then(t.bind(this._linkedInSdkLoaded,this)).done():(this._shareLinkNode=this._node.childNodes[0],this._restylableShare.attachEvents(this._shareLinkNode)),this._dispatchRenderedEvent()},_destroy:function(){this._linkedInCallback&&delete this._windowObject[this._linkedInCallback],this._restylableShare.detachEvents(this._shareLinkNode)},_generateHtml:function(){var e=this._getAttrs();return e.liUrl=e.liUrl||e.url||n.originWithPath(),this._useNetworkButton()?(e.extraAttrs=n.attrsToHtml(this._getOtherAttrs()),u(e)):this._restylableShare.generateHtml("linked-in",a+e.liUrl,e.liUrl)},_linkedInSdkLoaded:function(e){var r,s=this._node.childNodes[0];return s?(r=document.createElement("script"),this._linkedInCallback="linkedInShareCallback"+n.uuid(),this._windowObject[this._linkedInCallback]=t.partial(i.onShare,s.getAttribute("data-url")),r.setAttribute("data-onsuccess",this._linkedInCallback),t.each(s.attributes,function(e){r.setAttribute(e.name,e.value)}),this._node.removeChild(s),this._node.appendChild(r),e.parse(),void 0):!1},_useNetworkButton:function(){return this._restylableShare.useNetworkButton(this._getAttr("useNetworkButton"))}}),r.register("linked-in-share",o,null,["all-share"]),r.register("linked-in-public-share",o,null,["all-public-share"]),o}),n("gd-sdk/lib/twitter-sdk",["lib/p","gd-sdk/utils","gd-sdk/plugin/share/utils"],function(e,t,n){var i,r={},s="https://platform.twitter.com/widgets.js";return r.load=function(){var n;if(!i){if(i=e.defer(),window.twttr)return r._onLoad(),i.promise;n=t.loadExternalJs(s,"twitter-wjs"),n?n.then(r._onLoad).done():r._onLoad()}return i.promise},r._onLoad=function(){window.twttr.ready(function(){var e=function(e){var t;t=e.target?e.target.parentNode.getAttribute("data-url"):e,n.reportShare("twitter",t)};window.twttr.events.bind("tweet",e),i.resolve(window.twttr)})},r}),n("gd-sdk/plugin/share/twitter",["lib/bean","lib/lodash","gd-sdk/utils","gd-sdk/lib/twitter-sdk","gd-sdk/plugin/base","gd-sdk/plugin/share/_restylable"],function(e,t,n,i,r,s){var o,a=t.template("https://twitter.com/share?text=<%= twText %>&url=<%= twUrl %>"),u=t.template('<div data-url="<%= twUrl %>"><a class="gd-public-share-twitter twitter-share-button" href="https://twitter.com/share" data-url="<%= twUrl %>" data-text="<%= twText %>" <%= extraAttrs %>>Tweet</a></div>');return o=function(){o._super.apply(this,arguments),this._restylableShare=new s,this._shareLinkNode=null},r.extend(o,{_render:function(){var e=this._generateHtml();this._insertHtml(e),this._useNetworkButton()?i.load().then(t.bind(this._twitterSdkLoaded,this)).done():(this._shareLinkNode=this._node.childNodes[0],this._restylableShare.attachEvents(this._shareLinkNode)),this._dispatchRenderedEvent()},_destroy:function(){this._restylableShare.detachEvents(this._shareLinkNode)},_generateHtml:function(){var e=this._getAttrs();return e.twUrl=e.twUrl||e.url||n.originWithPath(),e.twText=e.twText||e.text||"",this._useNetworkButton()?(e.extraAttrs=n.attrsToHtml(this._getOtherAttrs()),u(e)):this._restylableShare.generateHtml("twitter",a(e),e.twUrl)},_twitterSdkLoaded:function(e){e.widgets.load()},_useNetworkButton:function(){return this._restylableShare.useNetworkButton(this._getAttr("useNetworkButton"))}}),r.register("twitter-share",o,null,["all-share"]),r.register("twitter-public-share",o,null,["all-public-share"]),o}),n("gd-sdk/plugins",["gd-sdk/plugin/alerts","gd-sdk/plugin/bar","gd-sdk/plugin/content-recommendations","gd-sdk/plugin/login","gd-sdk/plugin/on-screen-messages","gd-sdk/plugin/personal-share","gd-sdk/plugin/relevance-feedback","gd-sdk/plugin/social-recommendations","gd-sdk/plugin/user-status","gd-sdk/plugin/welcome","gd-sdk/plugin/share/email","gd-sdk/plugin/share/facebook","gd-sdk/plugin/share/google","gd-sdk/plugin/share/linked-in","gd-sdk/plugin/share/twitter"],function(){}),n("gd-sdk/short-url",["lib/p","lib/lodash","gd-sdk/request"],function(e,t,n){var i=function(e,t){this._trackingUrl=e,this._redirectWindow=t||window};return i.prototype={trackAndRedirect:function(){var i=e.defer();return n.send({url:this._trackingUrl}).then(t.bind(function(e){var t=JSON.parse(e.data);return t?(this._redirectWindow.location=t.url,i.resolve(),void 0):(i.reject(new Error("Could not process response for the given short URL.")),!1)},this),function(){i.reject()}).done(),i.promise}},i}),n("gd-sdk/lib/linked-in-connections-field",["lib/bean","lib/lodash","gd-sdk/sanitise","gd-sdk/utils"],function(e,t,n,i){var r=function(e){this._connectionItems={},this._chosenConnectionItems={},this._node=e,this._searchNode=null,this._chosenNode=null,this._connectionNode=null,this._connectionItemNodes=null,this._clearSearchQueryBound=t.bind(this._clearSearchQuery,this),this._searchQueryChangeBound=t.bind(this._searchQueryChange,this),this._connectionItemClickBound=t.bind(this._connectionItemClick,this),this._chosenConnectionItemClickBound=t.bind(this._chosenConnectionItemClick,this)};return r.prototype={render:function(){this._searchNode=this._node.querySelector(".linked-in-connections-search"),this._chosenNode=this._node.querySelector(".linked-in-connections-chosen"),this._connectionNode=this._node.querySelector(".linked-in-connections-suggestions"),this._connectionItemNodes=this._node.querySelectorAll(".linked-in-connections-suggestions li"),this._mapConnectionItems(),this._attachEvents()},_mapConnectionItems:function(){this._connectionItems=t.reduce(this._connectionItemNodes,function(e,t){var n=t.getAttribute("data-id"),i=t.getAttribute("data-friend-name");return e[n]={id:n,name:i,node:t},e},{})},_attachEvents:function(){e.on(this._searchNode,"keyup",this._searchQueryChangeBound),e.on(this._searchNode,"search",this._searchQueryChangeBound),e.on(this._connectionNode,"click",this._connectionItemClickBound),e.on(this._chosenNode,"click",this._chosenConnectionItemClickBound),e.on(window,"click",this._clearSearchQueryBound)},_clearSearchQuery:function(){this._searchNode.value="",this._searchQueryChange()},_searchQueryChange:function(e){var n="",r=!1;return e&&e.target&&(n=e.target.value||""),""!==n&&(this._connectionNode.style.display="",t.each(this._connectionItems,function(e){var t=i.contains(e.name,n);e.node.style.display=t?"":"none",r=r||t})),""!==n&&r?void 0:(this._connectionNode.style.display="none",!1)},_connectionItemClick:function(e){var n=e.target.hasAttribute("data-id")?e.target:e.target.parentNode,i=t.find(this._connectionItems,function(e){return e.node===n});return i?(this._addConnectionToChosen(i),this._clearSearchQuery(),void 0):!1},_chosenConnectionItemClick:function(e){var t,n;e.preventDefault(),"linked-in-connections-chosen-remove"===e.target.className&&(t=e.target.getAttribute("data-id"),n=this._chosenConnectionItems[t],this._chosenNode.removeChild(n.node),delete this._chosenConnectionItems[t])},_addConnectionToChosen:function(e){var i,r,s=t.some(this._chosenConnectionItems,function(t){return t.id===e.id});return s?!1:(i=document.createElement("li"),r="<span>"+e.name+"</span>",r+='<a class="linked-in-connections-chosen-remove" href="#" data-id="'+e.id+'">x</a>',r+='<input type="hidden" name="to" value="'+e.id+'" />',i.innerHTML=n.xss(r,["input"]),this._chosenConnectionItems[e.id]={id:e.id,node:i},this._chosenNode.appendChild(i),void 0)}},r}),n("gd-sdk/plugin/manager",["lib/lodash","gd-sdk/sanitise","gd-sdk/utils","gd-sdk/config"],function(e,t,n,i){var r=i.sdk.attrs.prefix;return{BEFORE:"before",AFTER:"after",FIRST:"first",LAST:"last",configurePluginNodes:function(t){return e.map(t,function(e){return this.configurePluginNode(e)},this)},configurePluginNode:function(n){var i,s,o,a=[];return n.selector&&(i=document.querySelectorAll(n.selector),i.length&&(s=i[0],s.getAttribute(r+"plugin")&&(o=s,e.each(o.attributes,function(e){0===e.name.indexOf(r)&&a.push(e.name)}),e.each(a,function(e){o.removeAttribute(e)})))),o||(o=document.createElement("div"),s&&this.insert(o,s,n.position)),n.plugin&&o.setAttribute(r+"plugin",t.xss(n.plugin)),e.each(n.options||{},function(e,n){o.setAttribute(r+n,t.xss(e.toString()))}),o},insert:function(e,t,n){if(!e)throw new ReferenceError("Must supply a node to insert into the DOM");if(!t)throw new ReferenceError("Must supply a reference node already in the DOM");switch(n){case this.BEFORE:t.parentNode.insertBefore(e,t);break;case this.AFTER:t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e);break;case this.FIRST:t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e);break;default:t.appendChild(e)}}}}),n("gd-sdk/metrics/activity",["lib/lodash","lib/bean","gd-sdk/config","gd-sdk/metrics/environment","gd-sdk/pubsub","gd-sdk/utils"],function(e,t,n,i,r,s){var o,a,u,l,c,d,h,g,p,f,m=!1,_=!1,b=40,v=40,y=200,k={ENVIRONMENT:"/gd/metrics/activity/environment",START:"/gd/metrics/activity/start",CHANGE:"/gd/metrics/activity/change",COMPLETE:"/gd/metrics/activity/complete"},w={STANDARD:{HIDDEN:"hidden",EVENT:"visibilitychange"},MOZ:{HIDDEN:"mozHidden",EVENT:"mozvisibilitychange"},MS:{HIDDEN:"msHidden",EVENT:"msvisibilitychange"},WEBKIT:{HIDDEN:"webkitHidden",EVENT:"webkitvisibilitychange"}};return e.each(e.keys(w),function(e){"undefined"!=typeof document[w[e].HIDDEN]&&(f=e)}),a={reset:function(){m=!1,_=!1,h=null,g=null,p=null,c&&(window.clearTimeout(c),c=null),d&&(window.clearTimeout(d),d=null)},resetPendingViewMetrics:function(){return p={url:window.location.href,startTimestamp:null,endTimestamp:null,pageSize:i.getPageSize(),viewPort:i.getViewportSize(),viewed:this._determineViewExtents(),cursor:[],clicks:[],scrolls:[],inactive:[]}},startTracking:function(){m||(this.reset(),m=!0,this.getCurrentViewMetrics(),this._reportMetrics(k.ENVIRONMENT,this.getEnvironmentMetrics()),this._startTrackingInteraction())},stopTracking:function(){m&&(m=!1,this._stopTrackingInteraction(),this._reportMetrics(k.COMPLETE,this.getCurrentViewMetrics()))},getInitialViewMetrics:function(){return h||(h={startTimestamp:s.now(),endTimestamp:s.now(),url:window.location.href,referrer:document.referrer,pageSize:i.getPageSize(),viewPort:i.getViewportSize(),position:i.getScroll(),viewed:this._determineViewExtents()}),h},getCurrentViewMetrics:function(){return g?g.endTimestamp=s.now():g=e.extend({},this.getPendingViewMetrics(),this.getInitialViewMetrics(),this.getEnvironmentMetrics()),g},getPendingViewMetrics:function(){var e;return p?g&&(e=this.getCurrentViewMetrics(),p.startTimestamp=e.startTimestamp,p.endTimestamp=s.now()):p=this.resetPendingViewMetrics(),p},getEnvironmentMetrics:function(){return{browser:i.getBrowserInfo(),screen:i.getScreenInfo(),sessionKey:n.sessionKey}},_reportMetrics:function(e,t){r.publish(e,t)},_determineViewExtents:function(){var e,t,n,r=i.getScroll(),s=i.getViewportSize(),o=i.getPageSize();return e=g&&g.viewed?{xMin:Math.min(g.viewed.xMin,r.x),xMax:Math.max(g.viewed.xMax,r.x+s.width),yMin:Math.min(g.viewed.yMin,r.y),yMax:Math.max(g.viewed.yMax,r.y+s.height)}:{xMin:r.x,xMax:r.x+s.width,yMin:r.y,yMax:r.y+s.height},n=(e.xMax-e.xMin)*(e.yMax-e.yMin),t=o.width*o.height,e.percentage=Math.round(100*(n/t)),e},_trackViewExtents:function(){g.pageSize=i.getPageSize(),g.viewed=this._determineViewExtents(),g.viewPort=i.getViewportSize(),p.pageSize=g.pageSize,p.viewed=g.viewed,p.viewPort=g.viewPort,this._onChange()},_startTrackingInteraction:function(){_||(_=!0,this._trackViewExtents(),this._addOrRemoveEvents(!0))},_stopTrackingInteraction:function(){_&&(_=!1,this._trackPageVisible(),this._trackViewExtents(),this._addOrRemoveEvents(!1))},_addOrRemoveEvents:function(n){var i=n?t.on:t.off;u||(u={},e.each(["_onScroll","_trackViewExtents","_trackClick","_onMouseMove","_onPageVisibilityChange","_trackPageVisible","_trackPageNotVisible"],function(t){u[t]=e.bind(this[t],this)},this)),i(window,{scroll:u._onScroll,resize:u._trackViewExtents}),i(document,{click:u._trackClick,mousemove:u._onMouseMove}),f?i(document,w[f].EVENT,u._onPageVisibilityChange):window.attachEvent?i(document,{focusin:u._trackPageVisible,focusout:u._trackPageNotVisible}):i(window,{focus:u._trackPageVisible,blur:u._trackPageNotVisible})},_onPageVisibilityChange:function(){this._isPageVisible()?this._trackPageVisible():this._trackPageNotVisible()},_isPageVisible:function(){return!f||!document[w[f].HIDDEN]},_trackPageNotVisible:function(){g.inactive.push({startTimestamp:s.now(),endTimestamp:null}),l={startTimestamp:s.now(),endTimestamp:null},this._onChange()},_trackPageVisible:function(){var e=g.inactive[g.inactive.length-1];e&&!e.endTimestamp&&(e.endTimestamp=s.now()),l&&(l.endTimestamp=s.now(),p.inactive.push(l),l=null),this._onChange()},_onScroll:function(){c&&window.clearTimeout(c),c=window.setTimeout(e.bind(this._trackScroll,this),b)},_trackScroll:function(){var e;c&&window.clearTimeout(c),e=i.getScroll(),e.timestamp=s.now()-b,g.scrolls.push(e),p.scrolls.push(e),this._trackViewExtents()},_onMouseMove:function(t){d&&window.clearTimeout(d),d=window.setTimeout(e.bind(this._trackCursorPosition,this,t),v)},_trackCursorPosition:function(e){var t;d&&window.clearTimeout(d),t={timestamp:e.timeStamp,x:e.clientX,y:e.clientY},g.cursor.push(t),p.cursor.push(t),this._onChange()},_trackClick:function(e){var t={timestamp:e.timeStamp,pageX:e.clientX,pageY:e.clientY,target:{html:e.target.outerHTML.substr(0,y),nodeName:e.target.nodeName.toLowerCase(),id:e.target.id||null,className:e.target.className||null,href:e.target.href||null,title:e.target.title||null,name:e.target.name||null},rightClick:e.rightClick,shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey};g.clicks.push(t),p.clicks.push(t),this._onChange()},_onChange:function(){this._reportMetrics(k.CHANGE,this.getCurrentViewMetrics())}},o={TOPICS:k},e.each(["getEnvironmentMetrics","getInitialViewMetrics","getPendingViewMetrics","getCurrentViewMetrics","startTracking","stopTracking","reset","resetPendingViewMetrics","_onChange","_reportMetrics"],function(t){o[t]=e.bind(a[t],a)}),o}),n("gd-sdk/metrics/metrics-service",["lib/bean","lib/lodash","lib/p","gd-sdk/config","gd-sdk/pubsub","gd-sdk/request","gd-sdk/metrics/activity"],function(e,t,n,i,r,s,o){var a,u,l,c,d={ENVIRONMENT:"environmentMetrics",POST_MORTEM:"postMortemMetrics"},h={ENVIRONMENT:"environment_metrics",START:"start_metrics",HEARTBEAT:"heartbeat_metrics",POST_MORTEM:"post_mortem_metrics"};return a={storage:window.localStorage,sync:function(e,t){var r=n.defer();return s.send({url:e===h.ENVIRONMENT?i.api.viewMetricsEnvironmentPath:i.api.viewMetricsPath,method:"post",dataType:"application/json",data:t||{}}).then(function(e){r.resolve(e)},function(e){r.reject(e)}).done(),r.promise},syncEnvironmentMetrics:function(e){return this.haveEnvironmentMetricsChanged(e)?(this.storeMetrics(d.ENVIRONMENT,e),this.sync(h.ENVIRONMENT,e)):void 0},syncPostMortemMetrics:function(){var e=this.retrieveMetrics(d.POST_MORTEM,!0);return e?(this.storage.removeItem(d.POST_MORTEM),this.sync(h.POST_MORTEM,e)):void 0},start:function(){var n=o.TOPICS;this.syncPostMortemMetrics(),l=t.bind(this.syncEnvironmentMetrics,this),r.subscribe(n.ENVIRONMENT,l),c=t.bind(this.storePostMortemMetrics,this),r.subscribe(n.CHANGE,c),u=t.bind(this._onBeforeUnload,this),e.on(window,"beforeunload",u),o.startTracking()},stop:function(){var t=o.TOPICS;o.stopTracking(),this.storePostMortemMetrics(),e.off(window,"beforeunload",u),r.unsubscribe(t.ENVIRONMENT,l),r.unsubscribe(t.CHANGE,c)},_onBeforeUnload:function(){this.stop(),this.storePostMortemMetrics()},haveEnvironmentMetricsChanged:function(e){var t=this.retrieveMetrics(d.ENVIRONMENT,!1);return"string"!=typeof e&&(e=JSON.stringify(e)),t!==e},retrieveMetrics:function(e,t){var n=this.storage.getItem(e);return n?t?JSON.parse(n):n:void 0},storeMetrics:function(e,t){"string"!=typeof t&&(t=JSON.stringify(t)),this.storage.setItem(e,t)},storePostMortemMetrics:function(){this.storeMetrics(d.POST_MORTEM,t.extend(o.getPendingViewMetrics(),{oldSessionKey:i.sessionKey}))}}}),n("gd-sdk/base",["lib/radio","lib/p","lib/lodash","gd-sdk/api","gd-sdk/config","gd-sdk/dom-ready","gd-sdk/logger","gd-sdk/pubsub","gd-sdk/plugins","gd-sdk/plugin/utils","gd-sdk/request","gd-sdk/transport/xhr","gd-sdk/short-url","gd-sdk/storage","gd-sdk/utils","gd-sdk/frame/api","gd-sdk/lib/linked-in-connections-field","gd-sdk/plugin/manager","gd-sdk/metrics/metrics-service"],function(e,t,n,i,r,s,o,a,u,l,c,d,h,g,p,f,m,_,b){var v,y={loadStylesheets:!0,autowire:[],sessionKey:null};return n=n.noConflict(),v=function(){this._options={},this.pubsub=a,this.api=i,this.session={sessionKey:null},this._boundSendEvent=n.bind(this._sendEvent,this)},v.prototype={init:function(e,i){var u,l=t.defer();return this._options=n.extend({},y,e||{}),this._windowObject=i||window,this.pubsub.subscribe("/gd/event/outbound",this._boundSendEvent),o.time("domReady.wait()"),s.wait().then(n.bind(function(){o.timeEnd("domReady.wait()"),r.api.frameOrigin=p.getFrameOrigin(),this._resolveKeys(),o.time("request.setup()"),u=c.setup(this._options.sessionKey),_.configurePluginNodes(this._options.autowire),this._options.loadStylesheets&&this._loadStylesheets(r.api.frameOrigin,p.isInDebugMode()?r.sdk.debugStylesheets:r.sdk.stylesheets),u.then(n.bind(function(){o.timeEnd("request.setup()"),o.debug("Session Key:",r.sessionKey),this.session={sessionKey:r.sessionKey},this._isDoNotTrackEnabled()||b.start(),this.startPlugins(),l.resolve(this),this._windowObject.setTimeout(function(){a.publish("/gd/session/changed",{sessionKey:r.sessionKey})},0),this._processShareReturn()},this),function(e){o.error("request.setup() failed",e),l.reject(e)})},this),function(e){o.error("domReady.wait() failed",e),l.reject(e)}).done(),l.promise},startPlugins:function(e){var i;i=e?l.startWithin(e):l.startAll(),t.allSettled(i).then(n.bind(this._checkForPluginEvents,this)).done()},_loadStylesheets:function(e,t){var i,r=document.getElementsByTagName("head")[0];n.each(t,function(t){i=document.createElement("link"),i.rel="stylesheet",i.href=e+t,r.childNodes.length>0?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)})},_startApiFrame:function(){return this._resolveKeys(),(new f).start()},_sendEvent:function(e){return i.post({url:r.api.pluginEventsPath,data:e})},_processShareReturn:function(){var e,t;this._windowObject.location&&(e=this._windowObject.location.search,t=p.qsToObject(e)[r.sdk.shareRef],t&&a.publishEventToGD("shared_page_loaded",{tiny_gd_code:t}))},_handleShortUrl:function(e){return r.api.frameOrigin=p.getFrameOrigin(),this._resolveKeys(),c.setup(),new h(e).trackAndRedirect()},_handleLinkedInConnectionsFields:function(){var e=document.querySelectorAll(".linked-in-connections");return n.map(e,function(e){var t=new m(e);return t.render(),t})},_checkForPluginEvents:function(e){p.allPromisesResolved(e)?i.get({url:r.api.pluginEventsPath}).then(function(e){a.publishEventsFromJson(e.events)}).done():o.error("One of the plugins failed to load, so not fetching events on this page load.",e)},_isDoNotTrackEnabled:function(e){return e=e||window,"1"===e.doNotTrack||"1"===e.navigator.doNotTrack||"yes"===e.navigator.doNotTrack||"1"===e.navigator.msDoNotTrack},_resolveKeys:function(){r.apiKey=p.getApiKey(),r.sdkFrameKey=p.getSdkFrameKey()}},v}),n("gd-sdk/gd-sdk",["gd-sdk/base","gd-sdk/logger"],function(e,t){var n=function(t){var n=new e;t=t||window,"function"==typeof t.gdLoaded?t.gdLoaded(n):n.init().done()};try{n()}catch(i){throw t.error(i),i}return n}),t(["gd-sdk/gd-sdk"])}();
//# sourceMappingURL=gd-sdk.min.js.map